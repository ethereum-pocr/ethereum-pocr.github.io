(function(e){function t(t){for(var n,s,c=t[0],i=t[1],u=t[2],d=0,p=[];d<c.length;d++)s=c[d],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&p.push(a[s][0]),a[s]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);l&&l(t);while(p.length)p.shift()();return o.push.apply(o,u||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,c=1;c<r.length;c++){var i=r[c];0!==a[i]&&(n=!1)}n&&(o.splice(t--,1),e=s(s.s=r[0]))}return e}var n={},a={index:0},o=[];function s(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=n,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=i;o.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},1:function(e,t){},10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},15:function(e,t){},16:function(e,t){},17:function(e,t){},18:function(e,t){},19:function(e,t){},2:function(e,t){},20:function(e,t){},21:function(e,t){},22:function(e,t){},23:function(e,t){},24:function(e,t){},3:function(e,t){},3062:function(e,t,r){(function(t){var n=r("970b").default,a=r("5bc3").default;r("d3b7"),r("25f0"),r("c19f"),r("5cc6"),r("907a"),r("9a8c"),r("a975"),r("735e"),r("c1ac"),r("d139"),r("3a7b"),r("d5d6"),r("82f8"),r("e91f"),r("60bd"),r("5f96"),r("3280"),r("3fcc"),r("ca91"),r("25a1"),r("cd26"),r("3c5d"),r("2954"),r("649e"),r("219c"),r("170b"),r("b39a"),r("72f7"),r("a630"),r("3ca3");var o="undefined"!==typeof t&&t.BigInt||"undefined"!==typeof window&&window.BigInt,s="function"===typeof o,c=r("7409"),i=function(e,t){switch(e){case"add":return function(e){return new u(t+e)};case"subtract":return function(e){return new u(t-e)};case"multiply":return function(e){return new u(t*e)};case"divide":return function(e){return new u(t/e)};case"remainder":return function(e){return new u(t%e)};case"pow":return function(e){return new u(Math.pow(t,e))};case"shiftLeft":return function(e){return new u(t<<e)};case"shiftRight":return function(e){return new u(t>>e)};case"and":return function(e){return new u(t&e)};case"or":return function(e){return new u(t|e)};case"xor":return function(e){return new u(t^e)};case"lt":return function(e){return t<e};case"gt":return function(e){return t>e};case"leq":return function(e){return t<=e};case"geq":return function(e){return t>=e};case"eq":return function(e){return t===e};case"neq":return function(e){return t!==e};case"negate":return function(){return new u(-t)};case"not":return function(){return new u(~t)};case"next":return function(){return new u(++t)};case"prev":return function(){return new u(--t)}}},u=function(){"use strict";function e(t){if(n(this,e),"bigint"===typeof t)this.value=t;else{if(t instanceof e)return t;this.value=new c(t)}return new Proxy(this,{get:function(e,t){return t in e?e[t]:"bigint"===typeof e.value?i(t,e.value):"bigint"!==typeof e.value&&t in e.value?e.value[t].bind(e.value):void 0}})}return a(e,[{key:"valueOf",value:function(){return"bigint"===typeof this.value?this.value:this}},{key:"equals",value:function(t){return"bigint"===typeof this.value?this.value===t.value:t instanceof e?"bigint"===typeof t.value?this.value.equals(new c(t.toString())):this.value.equals(new c(t.value)):this.value.equals(new c(t))}},{key:"toString",value:function(e){return this.value.toString(e)}},{key:"_toUint8ArrayNative",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,r=new ArrayBuffer(t),n=new DataView(r);return n.setBigUint64(0,this.value,e),new Uint8Array(r)}},{key:"_toUint8Array",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,r=new ArrayBuffer(t),n=new Uint8Array(r),a=this.value.toArray(Math.pow(2,8)).value;return e?n.set(a.reverse(),0):n.set(a,t-a.length),n}},{key:"toUint8Array",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;return"bigint"===typeof this.value?this._toUint8ArrayNative(e,t):this._toUint8Array(e,t)}}],[{key:"fromUint8Array",value:function(t){var r,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(s&&a){var o=new DataView(t.buffer);return new e(o.getBigUint64(0,n))}return r=n?Array.from(t).reverse():Array.from(t),new e(c.fromArray(r,Math.pow(2,8)))}}]),e}();e.exports=u}).call(this,r("c8ba"))},4:function(e,t){},5:function(e,t){},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",{attrs:{id:"inspire"}},[r("v-container",[r("app-menu",{model:{value:e.drawerDisplayed,callback:function(t){e.drawerDisplayed=t},expression:"drawerDisplayed"}}),r("v-app-bar",{attrs:{app:"","clipped-left":"",flat:"",color:"teal lighten-2"}},[e.drawerDisplayed?e._e():r("v-app-bar-nav-icon",{on:{click:e.showDrawer}}),r("v-toolbar-title",[e._v("Proof of Carbon Reduction")]),r("v-spacer"),r("v-chip",{staticClass:"ma-2",attrs:{color:"blue","text-color":"white"}},[e._v(" "+e._s(e.walletRole)+" ")]),e.wallet?r("v-chip",{staticClass:"ma-2",attrs:{color:"blue","text-color":"white"}},[r("v-icon",{staticClass:"mr-1",on:{click:e.disconnect}},[e._v("mdi-close")]),e._v(" "+e._s(e.wallet)+" ")],1):e._e(),r("v-chip",{staticClass:"ma-2",attrs:{color:"blue","text-color":"white"}},[e._v(" "+e._s(e.currentBlockNumber)+" ")]),r("v-chip",{staticClass:"ma-2",attrs:{color:"blue","text-color":"white"}},[e._v(" "+e._s(e.chainName)+" ")])],1),r("v-main",[r("v-container",{staticClass:"py-8"},[r("router-view")],1)],1)],1),r("v-overlay",{attrs:{value:e.mmIsOpen}},[r("v-progress-circular",{attrs:{indeterminate:""}})],1),r("v-overlay",{attrs:{value:e.mmConnecting}},[r("v-card",[r("v-card-title",[e._v("Authorize the connection of the website to the browser wallet")]),r("v-actions",[r("v-btn",{on:{click:e.cancelWalletConnection}},[e._v("Cancel")])],1)],1)],1),r("v-snackbar",{attrs:{"multi-line":"",color:e.snackbarColor,right:""},model:{value:e.displaySnackbar,callback:function(t){e.displaySnackbar=t},expression:"displaySnackbar"}},[e._v(" "+e._s(e.snackbarMessage)+" ")]),r("wallet-authentication-dialog",{ref:"walletAuthenticationDialog"})],1)},o=[],s=r("5530"),c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-navigation-drawer",{attrs:{app:"",clipped:"",flat:""},on:{input:e.drawerChange},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[r("v-divider"),r("v-list",[r("v-list-item-group",{attrs:{value:e.$route.name,mandatory:"",color:"primary"}},[e._l(e.sidenav,(function(t,n){var a=t.icon,o=t.label,s=t.route,c=t.disabled,i=t.subheader;return[i&&""!==o&&0!==n?r("v-divider",{key:o+"-divider"}):e._e(),i&&""!==o?r("v-subheader",{key:o},[e._v(e._s(o))]):r("v-list-item",{key:s,attrs:{value:s,disabled:c(),link:""},on:{click:function(t){return e.goTo(s)}}},[r("v-list-item-icon",[r("v-icon",[e._v(e._s(a))])],1),r("v-list-item-content",[r("v-list-item-title",[e._v(e._s(o))])],1)],1)]}))],2)],1),r("v-spacer"),r("img",{attrs:{src:"PoCR_Logo.png",width:"100%"}})],1)},i=[],u=r("b85c"),l=(r("d81d"),r("4de4"),r("d3b7"),r("b0c0"),r("fb6a"),r("caad"),r("7ffd")),d=r("8c4f"),p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.providerMetamask?e._e():r("div",[r("div",[e._v("Install MetaMask and then reload this application.")]),e._m(0)]),e.providerMetamask?r("div",[r("v-row",e._l(e.networks,(function(t){return r("v-col",{key:t.chainId,attrs:{cols:"4"}},[r("v-card",[r("v-card-title",[e._v(e._s(t.name))]),r("v-card-text",[r("div",[e._v(e._s(t.title))]),r("div",[e._v("chainID: "+e._s(t.chainId))])]),r("v-card-actions",[r("v-btn",{on:{click:function(r){return e.activateOrInstall(t)}}},[e._v("Activate")])],1)],1)],1)})),1)],1):e._e()])},f=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e._v("Installation instructions available at "),r("a",{attrs:{href:"https://metamask.io/download/",target:"_blank"}},[e._v("https://metamask.io/download/")])])}],v=r("2909"),h=r("1da1");r("96cf"),r("d9e2"),r("25f0"),r("a9e3"),r("99af"),r("8a79"),r("3ca3"),r("ddb0"),r("2b3d"),r("9861"),r("2532"),r("7db0");function m(e,t){if(t&&!Array.isArray(t)&&(t=[t]),t&&(t=t.map((function(e){return(e.endsWith(":")?e:e+":").toLowerCase()}))),e)try{var r=new URL(e);if(t&&!t.includes(r.protocol))return;return r}catch(n){return}}function b(e){return g.apply(this,arguments)}function g(){return g=Object(h["a"])(regeneratorRuntime.mark((function e(t){var r,n,a,o,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(n in t.activate_log?t.activate_log=!0:t.activate_log=!1,Array.isArray(t.networks)||(t.networks=[]),r=t.explorers||{},r)a=r[n],m(a,["http","https"])||delete r[n];t.explorers=r,o=Object(u["a"])(t.networks);try{for(o.s();!(s=o.n()).done;)c=s.value,m(c.nodeUrl,["http","https","ws","wss"])||delete c.nodeUrl,m(c.walletCustodyAPIBaseUrl,["http","https"])||delete c.walletCustodyAPIBaseUrl,m(c.explorerUrl,["http","https"])||delete c.explorerUrl,c.explorerUrl||t.explorers[c.chainID]&&(c.explorerUrl=t.explorers[c.chainID])}catch(i){o.e(i)}finally{o.f()}return 0==t.networks.length&&t.networks.push({name:"No network defined in the configuration"}),e.abrupt("return",t);case 9:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}function w(e){var t=e.networks.find((function(e){return e.default}));return!t&&e.networks.length>0&&(t=e.networks[0]),t}function k(e,t){var r,n=Object(u["a"])(e.networks);try{for(n.s();!(r=n.n()).done;){var a=r.value;a.nodeUrl==t?a.default=!0:a.default=!1}}catch(o){n.e(o)}finally{n.f()}return e}function x(e){return e.networks}function y(e,t){if(e){if(!t){var r=w(e);return r?r.explorerUrl?r.explorerUrl:y(e,r.chainID):void 0}return e.explorers[t]?e.explorers[t]:void 0}}var R=r("53ca");r("ac1f"),r("00b4");function O(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mustBeMetaMask,r=void 0!==t&&t,n=e.silent,a=void 0!==n&&n,o=e.timeout,s=void 0===o?3e3:o;i();var c=!1;return new Promise((function(e){function t(){if(a||console.log("detectEthereumProvider - handleEthereum()",c),!c){c=!0,window.removeEventListener("ethereum#initialized",t);var n=window,o=n.ethereum;if(a||console.log("detectEthereumProvider - decide return value",o,r),!o||r&&!o.isMetaMask){var s=r&&o?"Non-MetaMask window.ethereum detected.":"Unable to detect window.ethereum.";!a&&console.error("detectEthereumProvider:",s),e(void 0)}else e(o)}}window.ethereum?t():(a||console.log("detectEthereumProvider - no ethereum yet - wait for event or timeout"),window.addEventListener("ethereum#initialized",t,{once:!0}),setTimeout((function(){t()}),s))}));function i(){if("boolean"!==typeof r)throw new Error("detectEthereumProvider: Expected option 'mustBeMetaMask' to be a boolean.");if("boolean"!==typeof a)throw new Error("detectEthereumProvider: Expected option 'silent' to be a boolean.");if("number"!==typeof s)throw new Error("detectEthereumProvider: Expected option 'timeout' to be a number.")}}function _(e){return e?{connected:e.isConnected(),chainId:Number(e.chainId),chainIdHex:"0x".concat(Number(e.chainId).toString(16)),networkVersion:Number(e.networkVersion)}:{connected:!1}}function A(e){return C.apply(this,arguments)}function C(){return C=Object(h["a"])(regeneratorRuntime.mark((function e(t){var r,n,a,o=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:{},n=r.timeout,a=void 0===n?500:n,e.abrupt("return",new Promise((function(e){var r=!1;setTimeout((function(){r||(r=!0,e([]))}),a),t.request({method:"eth_accounts"}).then((function(t){r||(r=!0,e(t))})).catch((function(){r||(r=!0,e([]))}))})));case 2:case"end":return e.stop()}}),e)}))),C.apply(this,arguments)}function j(e){return"undefined"!==typeof e.message}function I(e,t,r){if(e){var n=e;if("string"==typeof n&&(n=new Error(n)),j(n)||(n=new Error(n)),Object(R["a"])(!n.code)&&"string"==typeof n.message)try{var a=JSON.parse(n.message);n.code=a.code,n.data=a.data,n.message=a.message}catch(e){n.code=t||0}return t&&(n.code=t),r&&(n.data=r),n}}function N(e,t){return P.apply(this,arguments)}function P(){return P=Object(h["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,n){var a=!1;r.once("cancel",(function(){a||(a=!0,n(I("Cancelled login",4001)))})),t.request({method:"eth_requestAccounts"}).then((function(t){a||(a=!0,e(t))})).catch((function(e){a||(a=!0,n(I(e)))}))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),P.apply(this,arguments)}function D(e,t,r){return S.apply(this,arguments)}function S(){return S=Object(h["a"])(regeneratorRuntime.mark((function e(t,r,n){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw I("missing a valid provider",-32602);case 2:if(r){e.next=4;break}throw I("missing the network parameter",-32602);case 4:if(/0x[0-9a-fA-F]+/.test(r.chainId)){e.next=6;break}throw I("missing the network chainId as an hex string (0x123)",-32602);case 6:return e.prev=6,e.next=9,t.request({method:"wallet_switchEthereumChain",params:[{chainId:r.chainId}]});case 9:e.next=29;break;case 11:if(e.prev=11,e.t0=e["catch"](6),a=I(e.t0),/wallet_addEthereumChain/.test(a.message)&&(a.code=4902),4902!=a.code){e.next=28;break}if(!n||!r.chainName){e.next=27;break}return e.prev=17,e.next=20,t.request({method:"wallet_addEthereumChain",params:[r,n]});case 20:e.next=25;break;case 22:throw e.prev=22,e.t1=e["catch"](17),I(e.t1);case 25:e.next=28;break;case 27:throw I("Cannot switch to the network because it does not exist and the call misses the network info and a valid account",-32602,r);case 28:throw a;case 29:case"end":return e.stop()}}),e,null,[[6,11],[17,22]])}))),S.apply(this,arguments)}var E={data:function(){return{networks:[]}},computed:Object(s["a"])(Object(s["a"])({},Object(l["c"])(["config"])),Object(l["c"])("auth",["provider","providerModel","providerMetamask","wallet"])),mounted:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.detectProvider();case 2:return t.next=4,fetch("https://chainid.network/chains.json");case 4:return r=t.sent,t.next=7,r.json();case 7:n=t.sent,e.networks=n.filter((function(e){return"CRC"==e.chain}));case 9:case"end":return t.stop()}}),t)})))()},methods:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(l["a"])(["errorFlash"])),Object(l["a"])("auth",["detectProvider","openMetaMaskConnectionDialog","attemptToConnectWallet"])),{},{activateOrInstall:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){var n,a,o,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.providerMetamask){r.next=2;break}throw new Error("metamask has not been installed");case 2:return n=t.providerMetamask.provider,a="0x"+Number(e.chainId).toString(16),o=y(t.config,e.chainId),r.prev=5,r.next=8,t.openMetaMaskConnectionDialog({noRedirect:!0});case 8:if(t.wallet){r.next=10;break}throw new Error("Could not find an account");case 10:if(s=_(n),s.chainId==e.chainId){r.next=16;break}return r.next=14,D(n,{chainId:a,chainName:e.name,rpcUrls:Object(v["a"])(e.rpc),nativeCurrency:e.nativeCurrency,blockExplorerUrls:e.explorers.filter((function(e){return"EIP3091"==e.standard})).map((function(e){return e.url})).concat(o)},t.wallet);case 14:r.next=17;break;case 16:t.attemptToConnectWallet();case 17:xn.push({name:"dashboard"}),r.next=23;break;case 20:r.prev=20,r.t0=r["catch"](5),t.errorFlash("Fail adding the network:"+r.t0.message);case 23:case"end":return r.stop()}}),r,null,[[5,20]])})))()}})},B=E,U=r("2877"),T=Object(U["a"])(B,p,f,!1,null,null,null),M=T.exports,V=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.hasProviderMetamask?r("div",[r("v-btn",{staticClass:" my-3",attrs:{color:"teal",dark:""},on:{click:e.prepareOpenMetaMaskConnectionDialog}},[e._v("Connect Metamask Wallet")]),r("v-btn",{staticClass:"mx-3 my-3",attrs:{color:"teal",dark:""},on:{click:e.goToInstallMetamask}},[e._v("Switch / Install network")])],1):e._e(),r("br"),r("br"),e.hasProviderDirect?r("div",[r("v-btn",{attrs:{color:"teal",dark:""},on:{click:e.prepareOpenWeb3DirectConnectionDialog}},[e._v("Connect with below configuration")]),e._v(" "),r("br"),r("br"),r("v-select",{attrs:{hint:"node: "+e.selectedNetwork.nodeUrl+"; custody: "+e.selectedNetwork.walletCustodyAPIBaseUrl,items:e.networks,"item-text":"name","item-value":"nodeUrl","persistent-hint":"","return-object":"","single-line":""},model:{value:e.selectedNetwork,callback:function(t){e.selectedNetwork=t},expression:"selectedNetwork"}}),e.hasCustodyApi?r("div",[r("br"),r("v-combobox",{attrs:{label:"Enter the wallet address",placeholder:"capture your wallet address",outlined:"",counter:"",clearable:"","search-input":e.wallet,items:e.wallets},on:{"update:search-input":e.updateWallet}}),r("v-text-field",{attrs:{label:"Enter the wallet password",placeholder:"capture your wallet password",outlined:"",type:e.show?"text":"password"},on:{"click:append":function(t){e.show=!e.show}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1):e._e()],1):e._e()])},F=[],L=(r("33d1"),r("ea98"),r("b64b"),r("130f"),r("1276"),r("e9c4"),r("a15b"),r("a434"),r("6062"),r("99e5")),W=r.n(L),H=r("3062"),$=r.n(H),G=r("cde1"),q=r("a086"),J=r("602f"),z=r("b955"),Y=r.n(z),K=r("2f62"),X=l["b"];l["b"].options.mapping="simple";r("25eb"),r("c740"),r("c35a"),r("2ca0"),r("4c53");var Q=r("86b4"),Z={VISITOR:"Visitor",AUDITED_NODE:"Audited node",NEW_NODE:"New node",APPROVED_AUDITOR:"Approved auditor",PENDING_AUDITOR:"Auditor",USER_CONNECTED:"User"},ee="https://github.com/ethereum-pocr/CRIPs/blob/main/CRIPS",te="0x0000000000000000000000000000000000000100",re="0x0000000000000000000000000000000000000101",ne="GeneratedPocRTotal",ae=W.a.utils.keccak256(ne),oe=10,se=function(){return{nbOfNodes:0,totalFootprint:0,totalCrypto:0,sealers:[],chainUpdateSubscription:null,blocks:[],currentBlockNumber:0,currentWalletBalanceWei:0,backupLoop:null,timeSinceLastBlock:0}},ce=function(e){return e.reduce((function(e,t){return e+t}),0)/e.length},ie={rewardsByBlock:function(e){var t=e.blocks.map((function(e){return e.sealer.lastReward}));return t.unshift(0),t},averageReward:function(e){if(0===e.blocks.length)return 0;var t=e.blocks.map((function(e){return e.sealer.lastReward}));return ce(t)},averageDelaySec:function(e){if(e.blocks.length<2)return 0;for(var t=e.blocks.length-Math.min(e.blocks.length,11),r=[],n=e.blocks.length-1;n>t;n--){var a=e.blocks[n-1],o=e.blocks[n];r.push((o.receivedAt-a.receivedAt)/1e3)}return 0==r.length?0:r.reduce((function(e,t){return t+e}),0)/r.length},lastBlock:function(e){return 0===e.blocks.length?null:e.blocks[e.blocks.length-1]},lastBlockNumber:function(e,t){var r;return null===(r=t.lastBlock)||void 0===r?void 0:r.block.number}},ue=l["d"].mutations(se);function le(e,t){return de.apply(this,arguments)}function de(){return de=Object(h["a"])(regeneratorRuntime.mark((function e(t,r){var n,a,o,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=it.get("auth/contract"),a=At(t),e.t0=t.utils,e.next=5,t.eth.getBalance(r.address);case 5:return e.t1=e.sent,o=e.t0.toBN.call(e.t0,e.t1),s=Number.parseFloat(t.utils.fromWei(o,"ether")),e.next=10,n.footprint(a.call(),r.address);case 10:return c=e.sent,r.footprint=Number.parseFloat(c),r.balance=s,r.lastReward=0,e.abrupt("return",r);case 15:case"end":return e.stop()}}),e)}))),de.apply(this,arguments)}function pe(e,t){return fe.apply(this,arguments)}function fe(){return fe=Object(h["a"])(regeneratorRuntime.mark((function e(t,r){var n,a,o,s,c,i,u,l,d,p,f,v,h;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("ProcessBloc",r.number,(new Date).toTimeString()),n=At(it.get("auth/provider")),a=it.get("auth/contract"),o={block:r,sealer:void 0},e.prev=4,"string"!==typeof r.difficulty||r.difficulty.startsWith("0x")||(r.difficulty=Number.parseInt(r.difficulty)),s="string"===typeof r.number?Number.parseInt(r.number):r.number,c=t.utils.toBN(0),i=t.utils.toBN(0),e.prev=9,e.t0=t.utils,e.next=13,t.eth.getStorageAt(re,ae,s-1);case 13:return e.t1=e.sent,c=e.t0.toBN.call(e.t0,e.t1),e.t2=t.utils,e.next=18,t.eth.getStorageAt(re,ae,s);case 18:e.t3=e.sent,i=e.t2.toBN.call(e.t2,e.t3),e.next=24;break;case 22:e.prev=22,e.t4=e["catch"](9);case 24:return o.sealer=Object(Q["poaBlockHashToSealerInfo"])(r),e.next=27,le(t,o.sealer);case 27:return o.sealer=e.sent,u=Number.parseFloat(t.utils.fromWei(i.sub(c),"ether")),o.sealer.lastReward=u,o.block.number=s,e.next=33,a.totalFootprint(n.call());case 33:return l=e.sent,e.next=36,a.nbNodes(n.call());case 36:d=e.sent,o.totalFootprint=Number.parseInt(l),o.totalCrypto=Number.parseFloat(t.utils.fromWei(i,"ether")),o.nbNodes=Number.parseInt(d),o.receivedAt=Date.now(),p=[],f=0;case 43:if(!(f<d)){e.next=54;break}return e.next=46,a.sealers(n.call(),f);case 46:return v=e.sent,e.next=49,a.isSealer(n.call(),v);case 49:h=e.sent,p.push({sealer:v,isSealer:h});case 51:f++,e.next=43;break;case 54:e.next=60;break;case 56:throw e.prev=56,e.t5=e["catch"](4),console.warn("Error in preparing block",e.t5),new Error("Fail processing block "+r.number);case 60:return e.abrupt("return",o);case 61:case"end":return e.stop()}}),e,null,[[4,56],[9,22]])}))),fe.apply(this,arguments)}function ve(e,t,r,n){return he.apply(this,arguments)}function he(){return he=Object(h["a"])(regeneratorRuntime.mark((function e(t,r,n,a){var o,c,i,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:while(r.length>0&&r[r.length-1].block.number>=a.number)r.pop();return e.next=3,pe(t,a);case 3:o=e.sent,r.push(o);while(r.length>=oe)r.shift();return c=n.findIndex((function(e){return e.address==o.sealer.address})),c<0?(i=Object(s["a"])(Object(s["a"])({},o.sealer),{},{sealedBlocks:1}),console.log("Creating new sealer",i),n.push(i)):(u=Object(s["a"])(Object(s["a"])({},n[c]),o.sealer),u.sealedBlocks++,n[c]=u),e.abrupt("return",{blocks:r,sealers:n});case 9:case"end":return e.stop()}}),e)}))),he.apply(this,arguments)}var me={fetchAllValues:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.dispatch,t.next=3,r("fetchNumberOfNodes");case 3:return t.next=5,r("fetchTotalFootprint");case 5:return t.next=7,r("updateNodesStatus");case 7:case"end":return t.stop()}}),t)})))()},initBackupLoop:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){var n,a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=e.state,a=e.commit,n.backupLoop&&clearInterval(t.backupLoop),a("timeSinceLastBlock",0),o=setInterval((function(){var e=it.get("nodes/lastBlock");if(e){var t=Date.now()-e.receivedAt;a("timeSinceLastBlock",t)}}),200),a("backupLoop",o);case 5:case"end":return r.stop()}}),r)})))()},fetchNumberOfNodes:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Tt("nbNodes");case 2:t=e.sent,it.set("nodes/nbOfNodes",Number.parseInt(t));case 4:case"end":return e.stop()}}),e)})))()},fetchTotalFootprint:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Tt("totalFootprint");case 2:t=e.sent,it.set("nodes/totalFootprint",Number.parseInt(t));case 4:case"end":return e.stop()}}),e)})))()},updateNodesStatus:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){var t,r,n,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=it.get("nodes/sealers"),r=Object(u["a"])(t),e.prev=2,r.s();case 4:if((n=r.n()).done){e.next=12;break}return a=n.value,e.next=8,Tt("isSealer",a.address);case 8:o=e.sent,a.isActive=o;case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](2),r.e(e.t0);case 17:return e.prev=17,r.f(),e.finish(17);case 20:it.set("nodes/sealers",t);case 21:case"end":return e.stop()}}),e,null,[[2,14,17,20]])})))()},subscribeToChainUpdates:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){var r,n,a,o,s,c,i,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.state,n=e.rootState,a=e.dispatch,null!==r.chainUpdateSubscription&&(r.chainUpdateSubscription.unsubscribe(),it.set("nodes/chainUpdateSubscription",null)),t.next=4,a("fetchChainInformations");case 4:o=n.auth.web3,s=Ut(o),c=!1,i=[],u=function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,void 0!=t.baseFeePerGas){e.next=5;break}return e.next=4,o.eth.getBlock(t.number);case 4:t=e.sent;case 5:return e.next=7,a("insertNewBlock",t);case 7:e.next=15;break;case 9:return e.prev=9,e.t0=e["catch"](0),console.warn("Error on receiving a new block",e.t0),i=[],e.next=15,a("subscribeToChainUpdates");case 15:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),s.on("data",function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!c){e.next=4;break}i.push(t),e.next=16;break;case 4:return e.prev=4,c=!0,e.next=8,u(t);case 8:if(!(t=i.shift())){e.next=13;break}return e.next=11,u(t);case 11:e.next=8;break;case 13:return e.prev=13,c=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[4,,13,16]])})));return function(t){return e.apply(this,arguments)}}()),it.set("nodes/chainUpdateSubscription",s);case 11:case"end":return t.stop()}}),t)})))()},unsubscribeToChainUpdates:function(){null!==se.chainUpdateSubscription&&se.chainUpdateSubscription.unsubscribe()},insertNewBlock:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function r(){var n,a,o,s,c,i,u,l,d;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n=e.state,a=e.rootState,o=e.commit,s=e.dispatch,c=it.get("auth/web3"),o("currentBlockNumber",t.number),!a.auth.wallet){r.next=8;break}return r.next=6,bt(a.auth.wallet);case 6:i=r.sent,o("currentWalletBalanceWei",i);case 8:return r.prev=8,r.next=11,ve(c,Object(v["a"])(n.blocks),Object(v["a"])(n.sealers),t);case 11:u=r.sent,l=u.blocks,d=u.sealers,it.set("nodes/blocks",l),it.set("nodes/sealers",d),l.length>0&&it.set("nodes/totalCrypto",l[l.length-1].totalCrypto),r.next=21;break;case 19:r.prev=19,r.t0=r["catch"](8);case 21:s("fetchAllValues");case 22:case"end":return r.stop()}}),r,null,[[8,19]])})))()},discoverNotRunningSealers:function(e){var t=e.rootState,r=e.state,n=t.auth.web3,a=t.auth.contract,o=new G["Web3FunctionProvider"](t.auth.provider,(function(){return Promise.resolve(a.deployedAt)})),s=Object(v["a"])(r.sealers);a.events.CarbonFootprintUpdate(o.get({fromBlock:1}),{}).on("log",function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=s.find((function(e){return e.address.toLowerCase()==t.returnValues.node.toLowerCase()})),r){e.next=7;break}return e.next=4,le(n,{address:t.returnValues.node.toLowerCase(),vanity:{custom:"Unknown innactive node"},sealedBlocks:0});case 4:a=e.sent,r=s.find((function(e){return e.address.toLowerCase()==a.address})),a.footprint>0&&void 0===r&&(console.log("Adding an innactive sealer",a),s.push(a),setTimeout((function(){return it.set("nodes/sealers",s)}),200));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},fetchChainInformations:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){var n,a,o,s,c,i,u,l,d,p;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.rootState,a=e.dispatch,o=n.auth.web3,s=Object(v["a"])(n.nodes.blocks||[]),c=Object(v["a"])(n.nodes.sealers||[]),i=s.length>0?s[s.length-1].block.number:0,r.next=7,o.eth.getBlockNumber();case 7:u=r.sent,t.blockNumber=u,l=Math.max(i+1,u-oe),console.log("From block",l,"to",u,"sealers count",c.length,"blocks count",s.length);case 11:if(!(l<u)){r.next=28;break}return r.next=14,o.eth.getBlock(l,!1);case 14:return d=r.sent,r.prev=15,r.next=18,ve(o,s,c,d);case 18:p=r.sent,s=p.blocks,c=p.sealers,r.next=25;break;case 23:r.prev=23,r.t0=r["catch"](15);case 25:l++,r.next=11;break;case 28:s.length>0&&it.set("nodes/totalCrypto",s[s.length-1].totalCrypto),it.set("nodes/blocks",s),it.set("nodes/sealers",c),a("discoverNotRunningSealers"),it.dispatch("auth/fetchRole");case 33:case"end":return r.stop()}}),r,null,[[15,23]])})))()},fetchOneNodeInfo:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function r(){var n,a,o,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n=e.rootState,a=n.auth.web3,o=n.nodes.sealers||[],s=o.findIndex((function(e){return e.address==t.toLowerCase()})),!(s>=0)){r.next=12;break}return r.next=7,le(a,o[s]);case 7:return o[s]=r.sent,it.set("nodes/sealers",o),r.abrupt("return",o[s]);case 12:return r.abrupt("return",void 0);case 13:case"end":return r.stop()}}),r)})))()},updateFootprint:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function r(){var n,a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.dispatch,a=t.sealerAddress,o=t.footprint,r.next=4,Yt(Lt("setFootprint",a,o));case 4:n("fetchOneNodeInfo",a),n("fetchAllValues");case 6:case"end":return r.stop()}}),r)})))()}},be={state:se,getters:ie,mutations:ue,actions:me,namespaced:!0},ge=r("faa1"),we=r.n(ge),ke=function(){return{web3:null,intf:null,provider:null,providerMetamask:null,providerDirect:null,providerModel:null,custodyModel:null,custodyApiUrl:null,wallet:null,delegatedWallet:null,contract:null,registered:!1,isNode:!1,isVoterNode:!1,isAuditor:!1,isAuditorApproved:!1,walletAuthenticationFunction:null,mmConnecting:!1,mmConnectionNotifier:new we.a}},xe={walletRole:function(e){return e.wallet?e.isVoterNode?Z.AUDITED_NODE:e.isNode?Z.NEW_NODE:e.isAuditorApproved?Z.APPROVED_AUDITOR:e.isAuditor?Z.PENDING_AUDITOR:Z.USER_CONNECTED:Z.VISITOR},explorerUrl:function(e){return"metamask"==e.providerModel?e.providerMetamask.explorerUrl:"direct"==e.providerModel?e.providerDirect.explorerUrl:void 0},chainName:function(e){var t=0;switch(e.providerModel){case"direct":t=e.providerDirect.chainID;break;case"metamask":t=e.providerMetamask.chainID;break}switch(t){case 1804:return"Kerleano";case 2606:return"PoCRNet"}return"Unknown"}},ye=l["d"].mutations(ke);function Re(){return Oe.apply(this,arguments)}function Oe(){return Oe=Object(h["a"])(regeneratorRuntime.mark((function e(){var t,r,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=function(){window.location=new URL(window.location.pathname,window.location.origin).href},t=it.get("config"),r=void 0,e.prev=3,e.next=6,O({timeout:2e3});case 6:r=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](3),console.log("fail detectEthereumProvider");case 12:if(!r){e.next=19;break}return r.removeListener("chainChanged",n),r.on("chainChanged",n),a=Number(r.chainId),e.abrupt("return",{providerModel:"metamask",provider:r,custodyModel:"metamask",custodyApiUrl:null,chainID:a,explorerUrl:y(t,a)});case 19:return e.abrupt("return",void 0);case 20:case"end":return e.stop()}}),e,null,[[3,9]])}))),Oe.apply(this,arguments)}function _e(){return Ae.apply(this,arguments)}function Ae(){return Ae=Object(h["a"])(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=it.get("config"),r=w(t),!r.nodeUrl){e.next=8;break}return n={providerModel:"direct",provider:mt(r.nodeUrl),custodyModel:null,custodyApiUrl:null,chainID:Number.parseInt(r.chainID),explorerUrl:y(t)},r.walletCustodyAPIBaseUrl?(n.custodyModel="api",n.custodyApiUrl=r.walletCustodyAPIBaseUrl):console.log("Note: No company's wallet custody configured"),e.abrupt("return",n);case 8:return console.log("Note: No direct web3 access configured"),e.abrupt("return",void 0);case 10:case"end":return e.stop()}}),e)}))),Ae.apply(this,arguments)}var Ce={checkNetworkProofOfCarbonReduction:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){var t,r,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=it.get("auth/web3"),r=it.get("auth/contract"),console.log("checkNetworkProofOfCarbonReduction",t),e.prev=3,e.next=6,t.eth.getBlockNumber();case 6:return n=e.sent,e.next=9,t.eth.getBlock(n);case 9:return a=e.sent,"string"!==typeof a.difficulty||a.difficulty.startsWith("0x")||(a.difficulty=Number.parseInt(a.difficulty)),Object(Q["poaBlockHashToSealerInfo"])(a),e.next=14,r.nbNodes(At().call());case 14:e.next=20;break;case 16:return e.prev=16,e.t0=e["catch"](3),console.error("Fail in checkNetworkProofOfCarbonReduction",e.t0),e.abrupt("return",e.t0.message);case 20:return e.abrupt("return",!1);case 21:case"end":return e.stop()}}),e,null,[[3,16]])})))()},fetchRole:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){var t,r,n,a,o,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("fetchRole called"),it.set("auth/isAuditor",!1),it.set("auth/isNode",!1),it.set("auth/isVoterNode",!1),t=it.get("auth/wallet"),!t){e.next=46;break}return e.next=8,Tt("auditorRegistered",t);case 8:return r=e.sent,e.next=11,Tt("auditorApproved",t);case 11:return n=e.sent,e.next=14,it.dispatch("nodes/fetchOneNodeInfo",t);case 14:if(a=e.sent,a){e.next=27;break}return e.prev=16,e.next=19,Tt("delegateOf",t);case 19:return o=e.sent,e.next=22,it.dispatch("nodes/fetchOneNodeInfo",o);case 22:a=e.sent,e.next=27;break;case 25:e.prev=25,e.t0=e["catch"](16);case 27:if(!a){e.next=44;break}return it.set("auth/isNode",!0),s=!1,e.prev=30,e.next=33,Tt("canActAsSealerNode",t);case 33:s=e.sent,e.next=42;break;case 36:return e.prev=36,e.t1=e["catch"](30),e.next=40,Tt("footprint",t);case 40:c=e.sent,s=c>0;case 42:it.set("auth/isVoterNode",s),it.set("auth/delegatedWallet",a.address);case 44:it.set("auth/isAuditor",r),it.set("auth/isAuditorApproved",n);case 46:case"end":return e.stop()}}),e,null,[[16,25],[30,36]])})))()},setConnection:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:it.set("auth/provider",t.provider),it.set("auth/providerModel",t.providerModel),r=new W.a(t.provider),r.eth.ens=null,it.set("auth/web3",r),window.myWeb3=r,it.set("auth/intf",null);case 7:case"end":return e.stop()}}),e)})))()},detectProvider:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){var r,n,a,o,s,c,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.dispatch,n=e.commit,a=e.state,a.contract||n("contract",kt()),console.log("Before detecting providers"),t.prev=3,t.next=6,it.dispatch("fetchConfig");case 6:return o=0,t.next=9,Re();case 9:return s=t.sent,s&&o++,t.next=13,_e();case 13:if(c=t.sent,c&&o++,0!=o){t.next=17;break}return t.abrupt("return");case 17:it.set("auth/providerMetamask",s),it.set("auth/providerDirect",c),o>1?it.set("auth/providerModel","both"):(i=c||s,r("setConnection",i)),t.next=25;break;case 22:t.prev=22,t.t0=t["catch"](3),console.error("Fail detecting a valid provider",t.t0.message);case 25:case"end":return t.stop()}}),t,null,[[3,22]])})))()},attemptToConnectWallet:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){var t,r,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=[],r=it.get("auth/providerMetamask"),n=it.get("auth/providerModel"),"metamask"!=n){e.next=7;break}return e.next=6,A(r.provider,{timeout:1e3});case 6:t=e.sent;case 7:if("direct"!=n||0!=t.length){e.next=11;break}return e.next=10,Ot();case 10:t=e.sent;case 11:if(console.log("attemptToConnectWallet",t),a=t.length>0?t[0]:null,a){e.next=15;break}return e.abrupt("return");case 15:return it.set("auth/wallet",a),e.abrupt("return",a);case 17:case"end":return e.stop()}}),e)})))()},cancelWalletConnection:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.state,r.mmConnecting&&r.mmConnectionNotifier.emit("cancel");case 2:case"end":return t.stop()}}),t)})))()},openMetaMaskConnectionDialog:function(e){var t=arguments;return Object(h["a"])(regeneratorRuntime.mark((function r(){var n,a,o,s,c,i,u,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.dispatch,a=e.state,o=e.commit,s=t.length>1&&void 0!==t[1]?t[1]:{},c=s.noRedirect,i=void 0!==c&&c,u=it.get("auth/providerMetamask"),it.set("auth/wallet",null),r.next=6,A(u.provider,{timeout:500});case 6:if(l=r.sent,0!=l.length){r.next=16;break}return r.prev=8,o("mmConnecting",!0),r.next=12,N(u.provider,a.mmConnectionNotifier);case 12:l=r.sent;case 13:return r.prev=13,o("mmConnecting",!1),r.finish(13);case 16:if(0!==l.length){r.next=18;break}return r.abrupt("return");case 18:if(it.set("auth/wallet",l[0]),n("setConnection",u),i){r.next=24;break}return r.next=23,n("fetchRole");case 23:xn.push({name:"dashboard"});case 24:case"end":return r.stop()}}),r,null,[[8,,13,16]])})))()},openWeb3DirectConnectionDialog:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function r(){var n,a,o,s,c,i,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.dispatch,a=t.wallet,o=t.password,s=t.nodeUrl,it.set("auth/wallet",null),c=it.get("config"),c=k(c,s),it.set("config",c),r.next=8,_e();case 8:if(i=r.sent,n("setConnection",i),"api"!=i.custodyModel){r.next=15;break}return r.next=13,yt(a,o);case 13:u=r.sent,u&&it.set("auth/wallet",a);case 15:return r.next=17,n("fetchRole");case 17:xn.push({name:"dashboard"});case 18:case"end":return r.stop()}}),r)})))()},disconnect:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,xn.push({name:"authentication"});case 2:it.set("auth/wallet",null);case 3:case"end":return e.stop()}}),e)})))()},fetchIsRegistered:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.state,t.next=3,Yt(Tt("auditorRegistered",r.wallet));case 3:n=t.sent,it.set("auth/registered",n);case 5:case"end":return t.stop()}}),t)})))()},selfRegister:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.dispatch,t.next=3,Yt($t("selfRegisterAuditor",{maxGas:2e5}));case 3:r("fetchIsRegistered"),r("status/fetchIsApproved",null,{root:!0}),r("fetchRole");case 6:case"end":return t.stop()}}),t)})))()}},je={state:ke,getters:xe,mutations:ye,actions:Ce,namespaced:!0},Ie=r("901e"),Ne=Math.pow(10,9),Pe=Math.pow(10,18);function De(e){return new Ie["BigNumber"](e)}function Se(e){return e.toNumber()}function Ee(e){return De(e).div(De(Ne))}function Be(e){return De(e).div(De(Pe))}function Ue(e,t){var r=De(e);return"ether"===t?r.multipliedBy(Pe):"gwei"===t?r.multipliedBy(Ne):r}function Te(e){return"0x"+e.toString(16)}window.Numberlib={toWebBigInt:De,toNumber:Se,toEther:Be,toGWei:Ee,toWei:Ue,toParam:Te};r("4dd0c");var Me=function(){return{pledgeHistory:[],footprintHistory:[]}},Ve={},Fe=Object(s["a"])(Object(s["a"])({},l["d"].mutations(Me)),{},{appendFootprint:function(e,t){e.footprintHistory.push(t)},appendPledge:function(e,t){e.pledgeHistory.push(t)}}),Le={fetchAllValues:function(e){var t=e.dispatch,r=new G["Web3FunctionProvider"](it.get("auth/provider"),(function(){return Promise.resolve(it.get("auth/wallet"))})),n=Y.a.get("Governance").at(te);t("fetchFootprintHistory",{contract:n,prov:r}),t("fetchPledgeHistory",{contract:n,prov:r})},fetchFootprintHistory:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function r(){var n,a,o,s,c,i,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=e.commit,a=e.rootState,o=t.contract,s=t.prov,c=it.get("auth/web3"),i=a.nodes.sealers,u=a.auth.wallet,it.set("history/footprintHistory",[]),o.events.CarbonFootprintUpdate(s.get({fromBlock:1}),{}).on("log",function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(t){var r,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c.eth.getTransaction(t.transactionHash);case 2:r=e.sent,a={blockNumber:t.blockNumber,auditor:r?r.from.toLowerCase():"no sealer!",node:t.returnValues.node.toLowerCase(),footprint:t.returnValues.footprint,txHash:t.transactionHash},o=i.find((function(e){return e.address==a.node})),a.nodeName=o?o.vanity.custom:"Not a node",a.auditor==u?a.auditorName="Me":a.auditorName=a.auditor,n("appendFootprint",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return r.stop()}}),r)})))()},fetchPledgeHistory:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function r(){var n,a,o,s,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=e.commit,a=e.rootState,o=t.contract,s=t.prov,c=a.auth.wallet,it.set("history/pledgeHistory",[]),o.events.AmountPledged(s.get({fromBlock:1}),{from:c}).on("log",function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r={blockNumber:t.blockNumber,auditor:t.returnValues.from,pledge:Be(t.returnValues.amountAdded)-Be(t.returnValues.amountRemoved),total:Be(t.returnValues.total),txHash:t.transactionHash},n("appendPledge",r);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return r.stop()}}),r)})))()}},We={state:Me,getters:Ve,mutations:Fe,actions:Le,namespaced:!0},He=function(){return{balance:0,minPledgeAmount:0,pledgedAmount:0,redeemBool:!1}},$e={},Ge=l["d"].mutations(He),qe={fetchAllValues:function(e){var t=e.dispatch;t("fetchBalance"),t("fetchMinPledgeAmount"),t("fetchPledgedAmount"),t("fetchCanTransferPledge")},fetchBalance:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.rootState,t.next=3,bt(r.auth.wallet);case 3:n=t.sent,it.set("pledge/balance",n);case 5:case"end":return t.stop()}}),t)})))()},fetchCanTransferPledge:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=it.get("auth/wallet"),e.next=3,Tt("canTransferPledge",t,"1");case 3:r=e.sent,console.log("just trying",r),it.set("pledge/redeemBool",r);case 6:case"end":return e.stop()}}),e)})))()},fetchMinPledgeAmount:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=it.get("auth/wallet"),e.next=3,Tt("minPledgeAmountToAuditNode",t);case 3:r=e.sent,it.set("pledge/minPledgeAmount",r);case 5:case"end":return e.stop()}}),e)})))()},fetchPledgedAmount:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=it.get("auth/wallet"),e.next=3,Tt("pledgedAmount",t);case 3:r=e.sent,it.set("pledge/pledgedAmount",Be(r));case 5:case"end":return e.stop()}}),e)})))()},addToPledge:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.dispatch,console.log("Pledging",t),r.next=4,Yt($t("pledge",{amount:Ue(t,"ether"),maxGas:3e5}));case 4:n("fetchPledgedAmount"),n("fetchBalance");case 6:case"end":return r.stop()}}),r)})))()},redeemPledge:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.dispatch,t.next=3,Yt(Lt("getPledgeBack"));case 3:r("fetchPledgedAmount"),r("fetchBalance");case 5:case"end":return t.stop()}}),t)})))()}},Je={state:He,getters:$e,mutations:Ge,actions:qe,namespaced:!0},ze=function(){return{approved:!1,approbationVotes:0}},Ye={},Ke=l["d"].mutations(ze),Xe={fetchIsApproved:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=it.get("auth/wallet"),e.next=3,Tt("auditorApproved",t);case 3:r=e.sent,it.set("status/approved",r);case 5:case"end":return e.stop()}}),e)})))()},fetchApprobationVotes:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=it.get("auth/wallet"),e.next=3,Tt("auditorVotes",t);case 3:r=e.sent,it.set("status/approbationVotes",Number(r));case 5:case"end":return e.stop()}}),e)})))()}},Qe={state:ze,getters:Ye,mutations:Ke,actions:Xe,namespaced:!0},Ze=function(){return{nbAuditors:0,auditors:[]}},et={},tt=l["d"].mutations(Ze),rt={fetchAllAuditorsValues:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.dispatch,t.next=3,r("fetchNbAuditors");case 3:return t.next=5,r("fetchAuditorsInfos");case 5:case"end":return t.stop()}}),t)})))()},fetchNbAuditors:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Tt("nbAuditors");case 2:t=e.sent,it.set("nodeGovernance/nbAuditors",t);case 4:case"end":return e.stop()}}),e)})))()},fetchAuditorsInfos:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){var t,r,n,a,o,s,c,i,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Tt("nbAuditors");case 2:return t=e.sent,r=it.get("auth/wallet"),e.t0=Math,e.next=7,Tt("nbNodes");case 7:e.t1=e.sent,e.t2=e.t1/2,e.t3=e.t0.floor.call(e.t0,e.t2),n=e.t3+1,a=[],o=0;case 13:if(!(o<t)){e.next=30;break}return e.next=16,Tt("auditorAddress",o);case 16:return s=e.sent,e.next=19,Tt("auditorVotes",s);case 19:return c=e.sent,e.next=22,Tt("currentAuditorVote",s,r);case 22:return i=e.sent,e.next=25,Tt("auditorApproved",s);case 25:u=e.sent,a[o]={address:s,nbVotes:c,minVotes:n,currentVote:i,isApproved:u};case 27:o++,e.next=13;break;case 30:it.set("nodeGovernance/auditors",a);case 31:case"end":return e.stop()}}),e)})))()},fetchConfiscatedPledge:function(){return Object(h["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Tt("confiscatedAmount");case 2:return t=e.sent,console.log("confiscated pledge",t,Object(R["a"])(t)),e.abrupt("return",Be(t));case 5:case"end":return e.stop()}}),e)})))()},voteAuditor:function(e,t){return Object(h["a"])(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.auditorAddress,n=t.accept,e.abrupt("return",Yt($t("voteAuditor",{maxGas:2e5},r,n)));case 2:case"end":return e.stop()}}),e)})))()}},nt={state:Ze,getters:et,mutations:tt,actions:rt,namespaced:!0};n["default"].use(K["a"]);var at=0,ot={tryingToConnect:!1,mmIsOpen:!1,displaySnackbar:!1,snackbarMessage:"",snackbarColor:"error",config:void 0},st=[],ct=new K["a"].Store({modules:{nodes:be,auth:je,history:We,pledge:Je,status:Qe,nodeGovernance:nt},plugins:[X.plugin],state:ot,mutations:l["d"].mutations(ot),getters:{logs:function(){return st}},actions:{errorFlash:function(e,t){var r=e.commit;r("snackbarMessage",t),r("snackbarColor","error"),r("displaySnackbar",!0)},fetchConfig:function(e){return Object(h["a"])(regeneratorRuntime.mark((function t(){var r,n,a,o,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,t.prev=1,n="./config.json",a=new URL(window.location.href),a.searchParams.has("config")&&(o=new URL(a.searchParams.get("config")),n=o.href,a.searchParams.delete("config")),t.next=7,fetch(n);case 7:if(s=t.sent,200!==s.status){t.next=17;break}return t.next=11,s.json();case 11:return c=t.sent,t.t0=r,t.next=15,b(c);case 15:t.t1=t.sent,(0,t.t0)("config",t.t1);case 17:t.next=22;break;case 19:t.prev=19,t.t2=t["catch"](1),r("config",void 0);case 22:case"end":return t.stop()}}),t,null,[[1,19]])})))()},addLog:function(e,t){var r=e.state,n=t.type,a=t.args;(!r.config||r.config&&r.config.activate_log)&&st.push({type:n,args:a,key:at++})}}}),it=ct,ut=console.log,lt=console.error,dt=console.warn;console.log=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];ut.apply(void 0,t),ct.dispatch("addLog",{type:"info",args:t})},console.warn=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];dt.apply(void 0,t),ct.dispatch("addLog",{type:"warn",args:t})},console.error=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];lt.apply(void 0,t),ct.dispatch("addLog",{type:"error",args:t})};var pt=r("d4ec"),ft=r("bee2"),vt=function(){function e(t){Object(pt["a"])(this,e),this.keyList=t||[]}return Object(ft["a"])(e,[{key:"getItem",value:function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(this.keyList.includes(t)||this.keyList.push(t),r=window.localStorage.getItem(t),r){e.next=6;break}return e.abrupt("return",void 0);case 6:return e.abrupt("return",JSON.parse(r));case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setItem",value:function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return this.keyList.includes(t)||this.keyList.push(t),r?window.localStorage.setItem(t,JSON.stringify(r)):window.localStorage.removeItem(t),e.abrupt("return");case 5:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getAll",value:function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(){var t,r,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t={},r=Object(u["a"])(this.keyList),e.prev=2,r.s();case 4:if((n=r.n()).done){e.next=11;break}return a=n.value,e.next=8,this.getItem(a);case 8:t[a]=e.sent;case 9:e.next=4;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](2),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:return e.abrupt("return",t);case 20:case"end":return e.stop()}}),e,this,[[2,13,16,19]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"setAll",value:function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=0,n=Object.keys(t);case 1:if(!(r<n.length)){e.next=8;break}return a=n[r],e.next=5,this.setItem(a,t[a]);case 5:r++,e.next=1;break;case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),ht=new vt;function mt(e){var t=new W.a(e);return t.currentProvider}function bt(e){return gt.apply(this,arguments)}function gt(){return gt=Object(h["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,it.get("auth/web3").eth.getBalance(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),gt.apply(this,arguments)}function wt(e){var t=Y.a.get(e),r=t.at(te);return console.log("Instance",r),r}function kt(){return wt("Governance")}function xt(){var e=it.get("auth/providerDirect").custodyApiUrl,t=new J["WalletCustodyApiImpl"](e,"eth");return t}function yt(e,t){return Rt.apply(this,arguments)}function Rt(){return Rt=Object(h["a"])(regeneratorRuntime.mark((function e(t,r){var n,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ht.getItem("custody.wallets");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=[];case 5:return n=e.t0,n.unshift(t),n=Object(v["a"])(new Set(n)),ht.setItem("custody.wallets",n),a=xt(),e.next=12,Yt(a.authenticate(t,r));case 12:return o=e.sent,e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)}))),Rt.apply(this,arguments)}function Ot(){return _t.apply(this,arguments)}function _t(){return _t=Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ht.getItem("custody.wallets");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=[];case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),e)}))),_t.apply(this,arguments)}function At(e){var t=it.get("auth/intf");if(t)return t;if(e||(e=it.get("auth/provider")),!e)throw new Error("Should not be calling the api functions without a provider connected");var r=it.get("auth/providerModel");if("metamask"==r){var n=it.get("auth/web3");t=new G["Web3FunctionProvider"](n,(function(e){return Promise.resolve(e[0])}))}if("direct"==r){var a=it.get("auth/wallet");if(a){var o=xt(),s=it.state.auth.walletAuthenticationFunction;t=new q["Web3CustodyFunctionProvider"](e,o,a,s)}else t=new G["Web3FunctionProvider"](e,(function(){return Promise.resolve(te)}))}if(t)return t.web3.eth.ens=null,it.set("auth/intf",t),t;throw new Error("should not be calling the api functions without deciding the provider (metamask or direct)")}var Ct={},jt=0,It=0,Nt=0,Pt=function(){Nt=Date.now();for(var e=0,t=Object.keys(Ct);e<t.length;e++){var r=t[e],n=Ct[r];n.when<=Nt&&setImmediate(n.callback)}},Dt=function(){It>0&&clearInterval(It),Nt=Date.now(),It=setInterval(Pt,50)};function St(e,t){var r=Date.now(),n=jt++;Ct[n]={when:r+t,callback:function(){delete Ct[n];try{e()}catch(t){console.log("timer callback failed - so what?",t)}}}}function Et(e){delete Ct[e]}["message","online","offline","pageshow"].forEach((function(e){return window.addEventListener(e,(function(){Date.now()-Nt>3e4&&(console.log("Setting the global timer"),Dt())}))}));var Bt=1e3;function Ut(e){if(e||(e=it.get("auth/web3")),!e)throw new Error("Should not be calling the api functions without a provider connected");var t=it.get("auth/provider"),r=it.get("auth/providerModel"),n="metamask"==r?function(e,r){t.sendAsync(Object(s["a"])(Object(s["a"])({},e),{},{skipCache:!0}),r)}:t.send.bind(t);function a(){return o.apply(this,arguments)}function o(){return o=Object(h["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){n({method:"eth_blockNumber",id:Bt++,params:[]},(function(r,n){r?t(r):n?e(n.result):t(new Error("No error or response!"))}))}));case 2:return t=e.sent,e.abrupt("return",Number(t));case 4:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)}t.sendAsync?t.sendAsync.bind(t):t.send.bind(t);var c=new ge["EventEmitter"]({captureRejections:!0});c.unsubscribe=function(){c.timer&&(Et(c.timer),c.timer=null)};var i=1e3;function u(){return l.apply(this,arguments)}function l(){return l=Object(h["a"])(regeneratorRuntime.mark((function t(){var r,n,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,c.props){t.next=9;break}return t.next=4,a();case 4:t.t0=t.sent,t.t1=Date.now(),c.props={lastBlock:t.t0,lastCheck:t.t1},t.next=30;break;case 9:return t.next=11,a();case 11:if(r=t.sent,n=Date.now(),!(r>c.props.lastBlock)){t.next=29;break}o=c.props.lastBlock+1;case 15:if(!(o<=r)){t.next=29;break}return t.prev=16,t.next=19,e.eth.getBlock(o,!1);case 19:s=t.sent,c.emit("data",s),t.next=26;break;case 23:t.prev=23,t.t2=t["catch"](16),console.warn("Fail getting block "+o,t.t2.message);case 26:o++,t.next=15;break;case 29:c.props={lastBlock:r,lastCheck:n};case 30:t.next=35;break;case 32:t.prev=32,t.t3=t["catch"](0),console.warn("Something went wront when processing the loop. Ignoring.",t.t3.message);case 35:c.timer=St(u,i);case 36:case"end":return t.stop()}}),t,null,[[0,32],[16,23]])}))),l.apply(this,arguments)}return c.timer=St(u,10),c}function Tt(e){return Mt.apply(this,arguments)}function Mt(){return Mt=Object(h["a"])(regeneratorRuntime.mark((function e(t){var r,n,a,o=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(r=o.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=o[a];return e.abrupt("return",Vt.apply(void 0,[t,{maxGas:1e7}].concat(n)));case 2:case"end":return e.stop()}}),e)}))),Mt.apply(this,arguments)}function Vt(e,t){return Ft.apply(this,arguments)}function Ft(){return Ft=Object(h["a"])(regeneratorRuntime.mark((function e(t,r){var n,a,o,s,c,i=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=it.get("auth/provider"),a=it.get("auth/contract"),t in a){e.next=4;break}return e.abrupt("return",Promise.reject(new Error("Method ".concat(t," does not exists in contract"))));case 4:for(o=i.length,s=new Array(o>2?o-2:0),c=2;c<o;c++)s[c-2]=i[c];return e.abrupt("return",a[t].apply(a,[Ht(At(n).call(r))].concat(s)));case 6:case"end":return e.stop()}}),e)}))),Ft.apply(this,arguments)}function Lt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return $t.apply(void 0,[e,{}].concat(r))}function Wt(e){"string"!==typeof e&&(e='\n {"message":"invalid error message"}');var t=e.split("\n");1==t.length&&(t="\n ".concat(JSON.stringify({message:e})).split("\n"));try{var r=JSON.parse(t.splice(1).join(" "));return r}catch(n){return{message:"invalid JSON message"}}}function Ht(e){return function(t,r){return e(t,r)}}function $t(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];var o=it.get("auth/wallet");if(!o)return Promise.reject(new Error("You are not authenticated with a wallet, you cannot update the blockchain"));var s=it.get("auth/provider"),c=it.get("auth/contract");return e in c?(t.amount&&(t.amount=new $.a(t.amount.toString(10))),new Promise((function(r,a){Vt.apply(void 0,[e,t].concat(n)).then(function(){var a=Object(h["a"])(regeneratorRuntime.mark((function a(o){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log("Tested call",t,o),a.t0=r,a.next=4,c[e].apply(c,[Ht(At(s).send(t))].concat(n));case 4:a.t1=a.sent,(0,a.t0)(a.t1);case 6:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()).catch((function(e){var t=Wt(e.message);a(t)}))}))):Promise.reject(new Error("Method ".concat(e," does not exists in contract")))}function Gt(e,t){return qt.apply(this,arguments)}function qt(){return qt=Object(h["a"])(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n='eth.sendTransaction({from: eth.coinbase, to:"'.concat(t,'", data:"').concat(r,'"})'),e.abrupt("return",{isTx:!0,result:n});case 2:case"end":return e.stop()}}),e)}))),qt.apply(this,arguments)}function Jt(e){return zt.apply(this,arguments)}function zt(){return zt=Object(h["a"])(regeneratorRuntime.mark((function e(t){var r,n,a,o,s,c=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(r=it.get("auth/contract"),n=c.length,a=new Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=c[o];return e.next=4,r[t].apply(r,[Gt].concat(a));case 4:return s=e.sent,console.log(s),e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)}))),zt.apply(this,arguments)}function Yt(e,t){return Kt.apply(this,arguments)}function Kt(){return Kt=Object(h["a"])(regeneratorRuntime.mark((function e(t,r){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=null,e.prev=1,it.set("mmIsOpen",!0),e.next=5,t;case 5:n=e.sent,e.next=15;break;case 8:e.prev=8,e.t0=e["catch"](1),a=e.t0.message,e.t0.blockHash&&e.t0.gasUsed&&0==e.t0.status&&(a="Not enough gas to complete the transaction: ".concat(e.t0.gasUsed," provided")),console.warn("Submitted transaction failed with error:",a),it.dispatch("errorFlash",a),r&&r(e.t0);case 15:return e.prev=15,it.set("mmIsOpen",!1),e.finish(15);case 18:return e.abrupt("return",n);case 19:case"end":return e.stop()}}),e,null,[[1,8,15,18]])}))),Kt.apply(this,arguments)}function Xt(e){return Qt.apply(this,arguments)}function Qt(){return Qt=Object(h["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,it.set("mmIsOpen",!0),e.next=4,t();case 4:e.next=10;break;case 6:e.prev=6,e.t0=e["catch"](0),console.log(e.t0),it.dispatch("errorFlash",e.t0.message);case 10:return e.prev=10,it.set("mmIsOpen",!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,6,10,13]])}))),Qt.apply(this,arguments)}var Zt={data:function(){return{wallet:void 0,wallets:[],networks:[],selectedNetwork:{name:"undefined"},password:void 0,show:!1}},mounted:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ot();case 2:r=t.sent,r.length>0&&(e.wallet=r[0]),e.wallets=r,n=e.$store.get("config"),e.networks=x(n),e.selectedNetwork=w(n);case 8:case"end":return t.stop()}}),t)})))()},computed:{hasProviderMetamask:function(){return!!this.$store.state.auth.providerMetamask},hasProviderDirect:function(){return!!this.$store.state.auth.providerDirect},hasCustodyApi:function(){return!(!this.$store.state.auth.providerDirect||"api"!=this.$store.state.auth.providerDirect.custodyModel)}},methods:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(l["a"])(["errorFlash"])),Object(l["a"])("auth",["openMetaMaskConnectionDialog","openWeb3DirectConnectionDialog","setConnection","checkNetworkProofOfCarbonReduction"])),{},{updateWallet:function(e){this.wallet=e},prepareOpenMetaMaskConnectionDialog:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.$store.state.auth.providerMetamask,r){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,e.setConnection(r);case 5:return t.next=7,e.checkNetworkProofOfCarbonReduction();case 7:if(t.sent){t.next=20;break}return t.prev=8,t.next=11,e.openMetaMaskConnectionDialog();case 11:t.next=17;break;case 13:return t.prev=13,t.t0=t["catch"](8),e.errorFlash("Could not connect an account from the wallet: "+t.t0.message),t.abrupt("return");case 17:e.goToDashboard(),t.next=21;break;case 20:e.goToInstallMetamask();case 21:case"end":return t.stop()}}),t,null,[[8,13]])})))()},prepareOpenWeb3DirectConnectionDialog:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.openWeb3DirectConnectionDialog({wallet:e.wallet,password:e.password,nodeUrl:e.selectedNetwork.nodeUrl});case 2:return t.next=4,Ot();case 4:e.wallets=t.sent;case 5:case"end":return t.stop()}}),t)})))()},goToInstallMetamask:function(){this.$router.push({name:"installMetaMask"})},goToDashboard:function(){this.$router.push({name:"dashboard"})}})},er=Zt,tr=Object(U["a"])(er,V,F,!1,null,null,null),rr=tr.exports,nr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-layout",{attrs:{col:"",wrap:""}},[r("v-card",{staticClass:"my-6 ma-auto",attrs:{height:"200",width:"300"}},[r("v-card-subtitle",[e._v("Block "),r("explorer",{attrs:{type:"block",id:e.lastBlock?e.lastBlock.block.number:0}})],1),r("v-card-title",{staticClass:"align-center"},[r("span",{staticClass:"text-h4 ma-auto",style:e.lastBlockNoTurnSealing?"color:red":""},[e._v(e._s(e.lastBlock&&e.lastBlock.block.number))])]),r("v-card-subtitle",[e._v("Total of "+e._s(e.totalCrypto.toFixed(2))+" ₡ created")]),r("v-card-subtitle",[e._v(e._s((e.timeSinceLastBlock/1e3).toFixed(2))+" sec. since last update")])],1),r("v-card",{staticClass:"my-6 ma-auto",attrs:{height:"200",width:"200"}},[r("v-card-subtitle",[e._v("Audited nodes")]),r("v-card-title",{staticClass:"align-center"},[r("span",{staticClass:"text-h2 ma-auto"},[e._v(e._s(e.nbOfNodes))])])],1),r("v-card",{staticClass:"my-6 ma-auto",attrs:{height:"200",width:"300"}},[r("v-card-subtitle",[e._v("Total footprint (g.CO₂ E)")]),r("v-card-title",{staticClass:"align-center"},[r("span",{staticClass:"text-h4 ma-auto"},[e._v(e._s(e.totalFootprint))])]),r("v-card-subtitle",{staticClass:"mt-3"},[e._v("Average: "+e._s((e.totalFootprint/e.nbOfNodes).toFixed(2))+" g.CO₂ E per node")])],1),r("v-row",[e.lastBlock?r("v-col",{staticClass:"py-8",attrs:{cols:"12"}},[r("v-card",[r("v-card-title",[e._v("Carbon Footprint for each of the nodes")]),r("v-card-subtitle",[e._v(" Last block sealer: "+e._s(e.lastBlock.sealer.address)+" / "+e._s(e.lastBlock.sealer.vanity.custom)+". Footprint: "+e._s(e.lastBlock.sealer.footprint)+" g.CO₂ ")]),r("v-card-text",e._l(e.sealersSorted,(function(t){return r("v-progress-linear",{key:t.address,staticClass:"my-1",attrs:{height:"2em",value:t.footprint/e.maxFootprint*100,color:e.gradientGreenToRed(t.footprint/e.maxFootprint)},scopedSlots:e._u([{key:"default",fn:function(n){return[e._v(" "+e._s(t.vanity.custom)+" - "),r("strong",[e._v(e._s(t.footprint))]),e._v(" g.CO₂ ")]}}],null,!0)})})),1)],1)],1):e._e(),e.lastBlock?r("v-col",{staticClass:"pb-8",attrs:{cols:"12"}},[r("v-card",[r("v-card-title",[e._v("Sealers")]),r("v-card-text",[r("v-data-table",{attrs:{items:e.sealers,headers:e.sealersHeaders,"items-per-page":-1,"hide-default-footer":""},scopedSlots:e._u([{key:"item.name",fn:function(t){var n=t.item;return[r("div",[r("v-icon",[e._v(e._s(n.isActive?"mdi-lock-open-check-outline":"mdi-lock-remove"))]),e._v(" "+e._s(n.vanity.custom))],1),r("div",[e._v(e._s(n.address))])]}},{key:"item.ratio",fn:function(t){var n=t.item;return[r("div",[e._v(e._s((100*n.sealedBlocks/e.totalSealedBlocks).toFixed(2))+" %")]),r("div",[e._v(e._s(n.sealedBlocks)+" / "+e._s(e.totalSealedBlocks))])]}},{key:"item.balance",fn:function(t){var n=t.item;return[r("div",[e._v(e._s(n.balance.toFixed(4)))])]}},{key:"item.lastReward",fn:function(t){var n=t.item;return[r("div",[e._v(e._s(n.lastReward.toFixed(4)))])]}},{key:"item.lastSealer",fn:function(t){var n=t.item;return[n.address==e.lastBlock.sealer.address?r("v-icon",[e._v("mdi-seal")]):e._e()]}}],null,!1,2192072440)})],1)],1)],1):e._e()],1)],1)},ar=[];r("4ec9"),r("4e82");function or(e,t,r,n){var a=t,o=r,s=e;n&&(s*=2,s>=1&&(s-=1,a=r,o=n));var c=o.red-a.red,i=o.green-a.green,u=o.blue-a.blue,l={red:parseInt(Math.floor(a.red+c*s),10),green:parseInt(Math.floor(a.green+i*s),10),blue:parseInt(Math.floor(a.blue+u*s),10)};return"rgb("+l.red+","+l.green+","+l.blue+")"}var sr={red:217,green:83,blue:79},cr={red:240,green:173,blue:78},ir={red:92,green:184,blue:91};function ur(e){return or(e,ir,cr,sr)}var lr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-icon",{attrs:{small:"",color:"blue"},on:{click:function(t){return e.open(e.url)}}},[e._v("mdi-open-in-new")])},dr=[],pr={props:{id:[String,Number],type:{type:String,validator:function(e){return["block","tx","token","account"].includes(e)}}},computed:{url:function(){var e=it.get("auth/explorerUrl");if(e){while(e.endsWith("/"))e=e.slice(0,e.length-1);var t=new URL("".concat(this.type,"/").concat(this.id),"".concat(e,"/"));return t.href}}},methods:{open:function(e){window.open(e,"POCR-EXPLORER")}}},fr=pr,vr=Object(U["a"])(fr,lr,dr,!1,null,null,null),hr=vr.exports,mr={components:{Explorer:hr},data:function(){return{nbBlocksToKeep:100,sealerMap:new Map,blocks:[],sealersReward:[],sealersHeaders:[{text:"Name",value:"name",align:"left"},{text:"Footprint (g.CO₂)",value:"footprint",align:"right"},{text:"Reward (₡)",value:"lastReward",align:"right"},{text:"Balance (₡)",value:"balance",align:"right"},{text:"Sealing ratio",value:"ratio",align:"center"},{text:"Last",value:"lastSealer"}]}},mounted:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Xt(e.fetchChainInformations);case 2:return t.next=4,e.fetchAllValues();case 4:return t.next=6,e.subscribeToChainUpdates();case 6:return t.next=8,e.initBackupLoop();case 8:case"end":return t.stop()}}),t)})))()},computed:Object(s["a"])(Object(s["a"])({},Object(l["c"])("nodes",["sealers","nbOfNodes","lastBlock","totalFootprint","totalCrypto","rewardsByBlock","averageReward","averageDelaySec","timeSinceLastBlock"])),{},{sealersSorted:function(){return Object(v["a"])(this.sealers).sort((function(e,t){return e.footprint-t.footprint}))},maxFootprint:function(){return this.sealers.reduce((function(e,t){return t.footprint>e?t.footprint:e}),1)},sealersFootprint:function(){return this.sealers.map((function(e){return e.footprint}))},sealersAddress:function(){return this.sealers.map((function(e){return e.address}))},sealersLabels:function(){return this.sealers.map((function(e){return e.vanity.custom}))},totalSealedBlocks:function(){return this.sealers.reduce((function(e,t){return e+t.sealedBlocks}),0)},lastBlockNoTurnSealing:function(){return this.lastBlock&&1==this.lastBlock.block.difficulty}}),methods:Object(s["a"])({gradientGreenToRed:ur},Object(l["a"])("nodes",["fetchAllValues","fetchChainInformations","subscribeToChainUpdates","initBackupLoop"]))},br=mr,gr=Object(U["a"])(br,nr,ar,!1,null,null,null),wr=gr.exports,kr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-row",[r("v-col",[r("v-card",[r("v-card-title",[e._v("Number of Auditors")]),r("v-card-text",[e._v(e._s(e.nbAuditors))])],1)],1),r("v-col",{attrs:{cols:"12"}},[r("v-card",[r("v-card-title",[e._v("Auditors")]),r("v-card-text",[r("v-data-table",{attrs:{items:e.auditors,headers:e.tableHeadersAuditors,"items-per-page":-1,"hide-default-footer":""},scopedSlots:e._u([{key:"item.status",fn:function(t){var n=t.item;return[r("div",[e._v(e._s(n.isApproved?"Oui":"Non"))])]}},{key:"item.votes",fn:function(t){var n=t.item;return[r("div",[e._v(e._s(n.nbVotes)+" / "+e._s(n.minVotes)+" avant "+e._s(n.isApproved?"Révocation":"Approbation"))])]}},{key:"item.actions",fn:function(t){var n=t.item;return[r("v-btn",{attrs:{color:"primary",small:""},on:{click:function(t){return e.nodeVote(n)}}},[e._v(" "+e._s(e.computeLabel(n))+" ")])]}}])})],1)],1)],1)],1)},xr=[],yr={data:function(){return{tableHeadersAuditors:[{text:"Auditor",value:"address"},{text:"Approuvé",value:"status"},{text:"Votes courants",value:"votes"},{text:"Actions",value:"actions",sortable:!1}],switchState:!1}},computed:Object(s["a"])({},Object(l["c"])("nodeGovernance",["nbAuditors","auditors"])),mounted:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchAllAuditorsValues();case 2:case"end":return t.stop()}}),t)})))()},methods:Object(s["a"])(Object(s["a"])({},Object(l["a"])("nodeGovernance",["fetchAllAuditorsValues","voteAuditor"])),{},{computeLabel:function(e){return e.isApproved?e.currentVote?"Voter pour révoquer":"Retirer mon vote de révocation":e.currentVote?"Retirer mon vote d'approbation":"Voter pour approuver"},nodeVote:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return console.log("address : ".concat(e.address," / vote value : ").concat(!e.currentVote)),r.prev=1,r.next=4,t.voteAuditor({auditorAddress:e.address,accept:!e.currentVote});case 4:return r.next=6,t.fetchAllAuditorsValues();case 6:r.next=14;break;case 8:return r.prev=8,r.t0=r["catch"](1),console.log(r.t0),r.next=13,t.fetchAllAuditorsValues();case 13:throw r.t0;case 14:case"end":return r.stop()}}),r,null,[[1,8]])})))()}})},Rr=yr,Or=Object(U["a"])(Rr,kr,xr,!1,null,null,null),_r=Or.exports,Ar=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-row",[r("v-col",[r("v-card",[r("v-card-title",[e._v("Number of Nodes")]),r("v-card-text",[e._v(e._s(e.nbOfNodes))])],1)],1),r("v-col",[r("v-card",[r("v-card-title",[e._v("Total Footprint")]),r("v-card-text",[e._v(e._s(e.totalFootprint)+" ")])],1)],1),r("v-col",{attrs:{cols:"12"}},[r("v-card",[r("v-card-title",[e._v("Nodes")]),r("v-card-text",[r("v-data-table",{attrs:{items:e.sealers,headers:e.tableHeaders,"items-per-page":-1,"hide-default-footer":""},scopedSlots:e._u([{key:"item.vanity",fn:function(t){var n=t.item;return[r("div",[e._v("Address: "+e._s(n.address))]),r("div",[e._v("Name: "+e._s(n.vanity.custom))])]}},{key:"item.actions",fn:function(t){var n=t.item;return[r("v-btn",{attrs:{color:"primary",small:""},on:{click:function(t){return e.openUpdateFootprintDialog(n)}}},[e._v(" Update footprint ")])]}}])}),r("v-dialog",{attrs:{width:"500"},model:{value:e.footprintDialog,callback:function(t){e.footprintDialog=t},expression:"footprintDialog"}},[e.selectedSealer?r("v-card",[r("v-card-title",[e._v(" Update Footprint for "+e._s(e.selectedSealer.address)+" ")]),r("v-card-text",[r("v-row",[r("v-col",{staticClass:"pb-0",attrs:{cols:"6"}},[r("v-text-field",{attrs:{type:"number",outlined:"",dense:""},model:{value:e.newFootprintValue,callback:function(t){e.newFootprintValue=t},expression:"newFootprintValue"}})],1),r("v-col",{staticClass:"pb-0"},[r("v-btn",{on:{click:function(t){e.footprintDialog=!1}}},[e._v("Cancel")])],1),r("v-col",{staticClass:"pb-0"},[r("v-btn",{attrs:{color:"primary"},on:{click:e.submitNewFootprint}},[e._v(" Submit ")])],1)],1)],1)],1):e._e()],1)],1)],1)],1)],1)},Cr=[],jr={data:function(){return{tableHeaders:[{text:"Node",value:"vanity"},{text:"Footprint",value:"footprint"},{text:"Actions",value:"actions",sortable:!1}],tableHeadersAuditors:[{text:"Auditor",value:"address"},{text:"Votes courants",value:"votes"},{text:"Mon Vote",value:"actions",sortable:!1}],footprintDialog:!1,selectedSealer:null,newFootprintValue:0}},computed:Object(s["a"])({},Object(l["c"])("nodes",["nbOfNodes","totalFootprint","sealers"])),mounted:function(){this.fetchAllValues()},methods:Object(s["a"])(Object(s["a"])({},Object(l["a"])("nodes",["fetchAllValues","updateFootprint"])),{},{openUpdateFootprintDialog:function(e){this.selectedSealer=e,this.newFootprintValue=e.footprint,this.footprintDialog=!0},submitNewFootprint:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.footprintDialog=!1,t.next=3,e.updateFootprint({sealerAddress:e.selectedSealer.address,footprint:e.newFootprintValue});case 3:case"end":return t.stop()}}),t)})))()}})},Ir=jr,Nr=Object(U["a"])(Ir,Ar,Cr,!1,null,null,null),Pr=Nr.exports,Dr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-row",[r("v-tabs",{attrs:{centered:"","slider-color":"primary"},model:{value:e.currentTab,callback:function(t){e.currentTab=t},expression:"currentTab"}},[r("v-tab",{attrs:{href:"#footprints"}},[e._v(" Footprints ")]),r("v-tab",{attrs:{href:"#pledges"}},[e._v(" Pledges ")])],1),r("v-tabs-items",{staticStyle:{width:"100%"},model:{value:e.currentTab,callback:function(t){e.currentTab=t},expression:"currentTab"}},[r("v-tab-item",{attrs:{value:"footprints"}},[r("v-card",[r("v-card-text",[r("v-data-table",{attrs:{items:e.footprintHistory,headers:e.footprintTableHeaders,"items-per-page":-1,"hide-default-footer":""},scopedSlots:e._u([{key:"item.node",fn:function(t){var n=t.item;return[r("div",[e._v(e._s(n.node))]),r("div",[e._v(e._s(n.nodeName))])]}},{key:"item.explorer",fn:function(e){var t=e.item;return[r("explorer",{attrs:{type:"tx",id:t.txHash}})]}}])})],1)],1)],1),r("v-tab-item",{attrs:{value:"pledges"}},[r("v-card",[r("v-card-title",[e._v("Your pledge history")]),r("v-card-text",[r("v-data-table",{attrs:{items:e.pledgeHistory,headers:e.pledgeTableHeaders,"items-per-page":-1,"hide-default-footer":""},scopedSlots:e._u([{key:"item.explorer",fn:function(e){var t=e.item;return[r("explorer",{attrs:{type:"tx",id:t.txHash}})]}}])})],1)],1)],1)],1)],1)},Sr=[],Er={components:{Explorer:hr},data:function(){return{currentTab:"footprints",footprintTableHeaders:[{text:"Block N°",value:"blockNumber"},{text:"Auditor",value:"auditorName"},{text:"Node",value:"node"},{text:"Assigned",value:"footprint"},{text:"",value:"explorer"}],pledgeTableHeaders:[{text:"Block N°",value:"blockNumber"},{text:"Pledge",value:"pledge"},{text:"Total",value:"total"},{text:"",value:"explorer"}]}},computed:Object(s["a"])({},Object(l["c"])("history",["footprintHistory","pledgeHistory"])),mounted:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.fetchAllValues();case 1:case"end":return t.stop()}}),t)})))()},methods:Object(s["a"])({},Object(l["a"])("history",["fetchAllValues"]))},Br=Er,Ur=Object(U["a"])(Br,Dr,Sr,!1,null,null,null),Tr=Ur.exports,Mr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-row",{attrs:{wrap:""}},[r("v-col",{attrs:{cols:"12"}},[r("v-card",[r("v-card-title",[e._v("Current Wallet Balance")]),r("v-card-text",[e._v(" "+e._s(e.toEther(e.balance))+" CRC ")])],1)],1),r("v-col",{attrs:{cols:"8"}},[r("v-card",[r("v-card-title",[e._v("Pledge Informations")]),r("v-card-text",[r("div",[e._v(" Min pledge to start audit: "+e._s(e.toEther(e.minPledgeAmount).toFixed(4))+" CRC ")]),r("div",[e._v("Current pledged amount: "+e._s(e.pledgedAmount.toFixed(4))+" CRC")]),r("v-btn",{attrs:{small:"",disabled:0===e.pledgedAmount||!e.redeemBool},on:{click:e.redeemPledge}},[e._v("Redeem Pledge")])],1)],1)],1),r("v-col",[r("v-card",[r("v-card-title",[e._v("Pledge Actions")]),r("v-card-text",[r("v-row",[r("v-col",{staticClass:"pb-0",attrs:{cols:"12"}},[r("v-text-field",{attrs:{dense:"","hide-details":"",outlined:"",type:"number",min:0,placeholder:"Amount to add to the pledge"},model:{value:e.amountToAdd,callback:function(t){e.amountToAdd=t},expression:"amountToAdd"}})],1),r("v-col",{attrs:{cols:"12"}},[r("v-btn",{staticStyle:{width:"100%"},attrs:{small:""},on:{click:e.pledgeMore}},[e._v("Pledge more")])],1)],1)],1)],1)],1)],1)},Vr=[],Fr={data:function(){return{intervalId:null,amountToAdd:0}},computed:Object(s["a"])({},Object(l["c"])("pledge",["balance","minPledgeAmount","pledgedAmount","redeemBool"])),mounted:function(){this.fetchAllValues(),this.intervalId=setInterval(this.fetchAllValues,6e4)},beforeRouteLeave:function(e,t,r){clearInterval(this.intervalId),r()},methods:Object(s["a"])(Object(s["a"])({toEther:Be},Object(l["a"])("pledge",["fetchAllValues","addToPledge","redeemPledge"])),{},{pledgeMore:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.addToPledge(e.amountToAdd);case 2:e.amountToAdd=0;case 3:case"end":return t.stop()}}),t)})))()}})},Lr=Fr,Wr=Object(U["a"])(Lr,Mr,Vr,!1,null,null,null),Hr=Wr.exports,$r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("v-card",{staticClass:"pa-md-4 mx-lg-auto"},[e.walletRole!=e.ROLES.VISITOR?r("v-card-title",[e._v(" "+e._s(e.walletRole)+" "+e._s(e.wallet)+" "),r("explorer",{attrs:{type:"account",id:e.wallet}})],1):r("v-card-title",[e._v(" Visitor")]),r("v-card-subtitle",[e._v(" "+e._s(e.currentWalletBalanceEth)+" CRC ")])],1),e.isAuditor?r("v-card",{staticClass:"pa-md-4 mx-lg-auto"},[r("v-card-title",[e._v(" Status ")]),e.registered&&e.approved?r("v-card-subtitle",{staticStyle:{color:"Green"}},[e._v(" APPROVED ")]):e._e(),e.registered&&!e.approved?r("v-card-subtitle",{staticStyle:{color:"red"}},[e._v(" AWAITING APPROVAL ")]):e._e(),e.registered&&!e.approved?r("v-card-text",[r("p",{staticStyle:{color:"black"}},[e._v(" You have the total vote of "+e._s(e.approbationVotes)+" ")])]):e._e()],1):e._e(),e.walletRole==e.ROLES.USER_CONNECTED?r("v-card",{staticClass:"pa-md-4 mx-lg-auto"},[r("v-card-text",[r("p",[e._v(" If you wish to become an auditor you must register here "),r("v-btn",{staticClass:"mx-2",attrs:{small:"",disabled:e.mmIsOpen},on:{click:e.selfRegister}},[e._v(" Self register ")])],1)]),r("v-card-text",[r("p",[e._v(" If you need this wallet to acts as a delegate for your node, execute the following command from your node eth console "),r("code",[e._v(e._s(e.registerDelegateCommandLine))])])])],1):e._e()],1)},Gr=[],qr=(r("b680"),{components:{Explorer:hr},data:function(){return{registerDelegateCommandLine:""}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({ROLES:function(){return Z},mmIsOpen:Object(l["c"])("mmIsOpen")},Object(l["c"])("auth",["registered","walletRole","wallet"])),Object(l["c"])("status",["approved","approbationVotes"])),Object(l["c"])("nodes",["currentWalletBalanceWei"])),{},{currentWalletBalanceEth:function(){return Be(this.currentWalletBalanceWei).toFixed(4)},isAuditor:function(){return[Z.APPROVED_AUDITOR,Z.PENDING_AUDITOR].includes(this.walletRole)}}),mounted:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.fetchIsRegistered(),e.fetchIsApproved(),e.fetchApprobationVotes(),t.next=5,Jt("allowDelegate",e.wallet);case 5:e.registerDelegateCommandLine=t.sent;case 6:case"end":return t.stop()}}),t)})))()},methods:Object(s["a"])(Object(s["a"])({},Object(l["a"])("auth",["fetchIsRegistered","selfRegister"])),Object(l["a"])("status",["fetchIsApproved","fetchApprobationVotes"]))}),Jr=qr,zr=Object(U["a"])(Jr,$r,Gr,!1,null,null,null),Yr=zr.exports,Kr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-row",[r("v-col",{attrs:{cols:"12"}},[r("h2",[e._v("Manage the confiscated pledge of the auditors")])]),r("v-col",{attrs:{cols:"12"}},[r("v-card",[r("v-card-title",[e._v("Total confiscated pledge")]),r("v-card-text",[e._v(e._s(e.totalPledge)+" CRC")])],1)],1)],1)},Xr=[],Qr={data:function(){return{totalPledge:0}},mounted:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchConfiscatedPledge();case 2:e.totalPledge=t.sent;case 3:case"end":return t.stop()}}),t)})))()},methods:Object(s["a"])({},Object(l["a"])("nodeGovernance",["fetchConfiscatedPledge"]))},Zr=Qr,en=Object(U["a"])(Zr,Kr,Xr,!1,null,null,null),tn=en.exports,rn=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-row",[r("v-col",{staticClass:"pb-0",attrs:{cols:"12"}},[r("v-card",[r("v-card-title",[e._v("Page to manage PoCR improvement proposals.")])],1)],1),r("v-col",{staticClass:"pb-0",attrs:{cols:"12"}},[e.isConnected?r("v-card",{staticClass:"pa-2"},[r("v-card-subtitle",[e._v("Create a new proposal.")]),r("v-card-text",[e._v(" this action will be done with your connected wallet and will reserve the ID of the Carbon Reduction Improvement Proposal that you must then create as a document in "),r("a",{attrs:{href:e.CRIPsUrl}},[e._v(e._s(e.CRIPsUrl))])]),r("v-card-actions",[e.lastCRIPCreated?r("v-card-text",[e._v(" You have reserved the CRIP id "),r("code",[e._v(e._s(e.lastCRIPCreated))])]):r("v-btn",{attrs:{color:"primary",small:""},on:{click:e.reserveCRIP}},[e._v(" Reserve the next CRIP id ")])],1)],1):e._e()],1),r("v-col",{staticClass:"pb-0",attrs:{cols:"12"}},[r("v-card",{staticClass:"pa-2"},[r("v-card-title",[e._v("List of the improvement proposals")]),r("v-card-text",[r("v-data-table",{attrs:{items:e.CRIPS,headers:e.cripsTableHeaders,"items-per-page":-1,"hide-default-footer":""},scopedSlots:e._u([{key:"item.createdBlock",fn:function(t){var n=t.item;return[r("div",[e._v(e._s(n.createdBlock)+" "),r("explorer",{attrs:{type:"block",id:n.createdBlock}})],1)]}},{key:"item.documentation",fn:function(t){var n=t.item;return[r("a",{attrs:{href:n.url}},[e._v("crip-"+e._s(n.index)+".md")])]}},{key:"item.voteFromBlock",fn:function(t){var n=t.item;return[r("div",[e._v(e._s(e.voteFromContent(n.index)))]),r("div",[e._v("at "+e._s(n.voteFromBlock))])]}},{key:"item.voteUntilBlock",fn:function(t){var n=t.item;return[r("div",[e._v(e._s(e.voteUntilContent(n.index)))]),r("div",[e._v("at "+e._s(n.voteUntilBlock))])]}},{key:"item.auditors",fn:function(t){var n=t.item;return[r("div",[e._v("Pro: "+e._s(n.auditorsFor))]),r("div",[e._v("Cons: "+e._s(n.auditorsAgainst))])]}},{key:"item.nodes",fn:function(t){var n=t.item;return[r("div",[e._v("Pro: "+e._s(n.nodesFor))]),r("div",[e._v("Cons: "+e._s(n.nodesAgainst))])]}},{key:"item.useraction",fn:function(t){var n=t.item;return[e.canVote(n.index)?r("v-radio-group",{on:{change:function(t){return e.userVote(n)}},model:{value:n.vote,callback:function(t){e.$set(n,"vote",t)},expression:"item.vote"}},[r("v-radio",{attrs:{label:"agree",value:!0}}),r("v-radio",{attrs:{label:"reject",value:!1}})],1):e._e()]}}])})],1)],1)],1),r("v-col",{staticClass:"pb-0",attrs:{cols:"12"}},[r("v-card",{staticClass:"pa-2"},[r("v-card-title",[e._v("Your votes")]),r("v-card-text",[r("v-data-table",{attrs:{items:e.userVotes,headers:e.votesTableHeaders,"items-per-page":-1,"hide-default-footer":""},scopedSlots:e._u([{key:"item.block",fn:function(t){var n=t.item;return[r("div",[e._v(e._s(n.block)+" "),r("explorer",{attrs:{type:"tx",id:n.txHash}})],1)]}}])})],1)],1)],1)],1)},nn=[],an={components:{Explorer:hr},data:function(){return{lastCRIPCreated:void 0,CRIPS:[],userVotes:[],cripsTableHeaders:[{text:"Created on",value:"createdBlock"},{text:"Doc",value:"documentation"},{text:"Start in",value:"voteFromBlock"},{text:"Auditors votes",value:"auditors"},{text:"Nodes votes",value:"nodes"},{text:"Closes on",value:"voteUntilBlock"},{text:"Action",value:"useraction"}],votesTableHeaders:[{text:"Created on",value:"block"},{text:"CRIP id",value:"index"},{text:"Decision",value:"decision"}]}},computed:{blockNumber:function(){return it.get("nodes/currentBlockNumber")},CRIPsUrl:function(){return ee},isConnected:function(){return!!it.get("auth/wallet")},isNode:function(){return it.get("auth/walletRole")==Z.AUDITED_NODE},isAuditor:function(){return it.get("auth/walletRole")==Z.APPROVED_AUDITOR}},mounted:function(){this.fetchCRIPS(),this.fetchUserVotes()},methods:{reserveCRIP:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=new G["Web3FunctionProvider"](it.get("auth/provider"),(function(){return Promise.resolve(it.get("auth/wallet"))})),n=it.get("auth/contract"),a=e.blockNumber,t.next=5,Yt($t("newProposal",{maxGas:1e5}));case 5:n.events.IPChanged(r.get({fromBlock:a}),{status:0}).once("log",(function(t){e.lastCRIPCreated=t.returnValues.index,e.fetchCRIPS()}));case 6:case"end":return t.stop()}}),t)})))()},fetchCRIPS:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var r,n,a,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Tt("nbImprovementProposals");case 2:r=t.sent,n=[],a=0;case 5:if(!(a<r)){t.next=18;break}return t.next=8,Tt("getImprovementProposal",a);case 8:o=t.sent,o.index=Number.parseInt(o.index),o.voteFromBlock=Number.parseInt(o.voteFromBlock),o.voteUntilBlock=Number.parseInt(o.voteUntilBlock),s=new URL("".concat(ee,"/crip-").concat(o.index,".md")),o.url=s.href,n.push(o);case 15:a++,t.next=5;break;case 18:e.CRIPS=n;case 19:case"end":return t.stop()}}),t)})))()},fetchUserVotes:function(){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function t(){var r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=it.get("auth/delegatedWallet")||it.get("auth/wallet"),n=new G["Web3FunctionProvider"](it.get("auth/provider"),(function(){return Promise.resolve(r)})),a=it.get("auth/contract"),e.userVotes=[],a.events.IPVote(n.get({fromBlock:1}),{voter:r}).on("log",(function(t){console.log("Vote log",t),e.userVotes.push({index:Number.parseInt(t.returnValues.index),approval:Number.parseInt(t.returnValues.vote)>0,decision:Number.parseInt(t.returnValues.vote)>0?"Accepted":"Rejected",txHash:t.transactionHash,block:t.blockNumber})}));case 5:case"end":return t.stop()}}),t)})))()},canVote:function(e){var t=this.CRIPS.find((function(t){return t.index==e}));if(!t)return!1;var r=this.blockNumber,n=t.voteFromBlock<=r&&t.voteUntilBlock>=r;return n&&(this.isNode||this.isAuditor)},voteFromContent:function(e){var t=this.CRIPS.find((function(t){return t.index==e}));if(!t)return"N/A";var r=t.voteFromBlock-this.blockNumber;return console.log("voteFromContent",e,t,r),r<=0?"Opened":(4*r/86400).toFixed(2)+" days"},voteUntilContent:function(e){var t=this.CRIPS.find((function(t){return t.index==e}));if(!t)return"N/A";var r=t.voteUntilBlock-this.blockNumber;return console.log("voteFromContent",e,t,r),r<=0?"Closed":(4*r/86400).toFixed(2)+" days"},userVote:function(e){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(console.log("User vote",e.index,e.vote),"boolean"===typeof e.vote){r.next=3;break}return r.abrupt("return");case 3:return n=e.vote?"voteForProposal":"voteAgainstProposal",r.next=6,Yt($t(n,{maxGas:1e5},e.index));case 6:a=r.sent,null===a&&(e.vote=null),t.fetchCRIPS(),t.fetchUserVotes();case 10:case"end":return r.stop()}}),r)})))()}}},on=an,sn=Object(U["a"])(on,rn,nn,!1,null,null,null),cn=sn.exports,un=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",e._l(e.logs,(function(t){return r("div",{key:t.key},[r("v-chip",[e._v(e._s(t.type))]),e._v(" "+e._s(t.args.map((function(e){return"object"==typeof e?"OBJ":e})).join(" "))+" ")],1)})),0)},ln=[],dn={data:function(){return{}},computed:Object(s["a"])({},Object(l["c"])(["logs"])),mounted:function(){},methods:{}},pn=dn,fn=Object(U["a"])(pn,un,ln,!1,null,null,null),vn=fn.exports;n["default"].use(d["a"]);var hn=function(e){var t=e.store;return!t.state.auth.wallet},mn=function(e){return function(t){var r=t.store;return r.get("auth/walletRole")==e}},bn=function(e){return function(t){return!e(t)}},gn=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){var r,n=Object(u["a"])(t);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a(e))return!0}}catch(o){n.e(o)}finally{n.f()}return!1}},wn=[{name:"dashboard",path:"/dashboard",component:wr,meta:{displayInSidenav:""}},{name:"status",path:"/status",component:Yr,meta:{displayInSidenav:"",restricted:bn(mn(Z.VISITOR)),forceRedirectTo:"dashboard",hidden:mn(Z.VISITOR)}},{name:"improvements",path:"/improvements",component:cn,meta:{displayInSidenav:"",forceRedirectTo:"dashboard"}},{name:"installMetaMask",path:"/installmetamask",component:M},{name:"authentication",path:"/auth",component:rr,meta:{displayInSidenav:"",hidden:function(e){var t=e.store;return!hn({store:t})}}},{name:"auditors",path:"/auditors",component:_r,meta:{displayInSidenav:"Governance",restricted:gn(mn(Z.AUDITED_NODE),mn(Z.NEW_NODE)),forceRedirectTo:"dashboard",hidden:bn(gn(mn(Z.AUDITED_NODE),mn(Z.NEW_NODE)))}},{name:"confiscated-pledge",path:"/confiscated",component:tn,meta:{displayInSidenav:"Governance",restricted:gn(mn(Z.AUDITED_NODE),mn(Z.NEW_NODE)),forceRedirectTo:"dashboard",hidden:bn(gn(mn(Z.AUDITED_NODE),mn(Z.NEW_NODE)))}},{name:"pledge",path:"/pledge",component:Hr,meta:{displayInSidenav:"Audit",restricted:mn(Z.APPROVED_AUDITOR),forceRedirectTo:"status",hidden:bn(gn(mn(Z.PENDING_AUDITOR),mn(Z.APPROVED_AUDITOR)))}},{name:"audit",path:"/audit",component:Pr,meta:{displayInSidenav:"Audit",restricted:mn(Z.APPROVED_AUDITOR),forceRedirectTo:"status",hidden:bn(gn(mn(Z.PENDING_AUDITOR),mn(Z.APPROVED_AUDITOR)))}},{name:"history",path:"/history",component:Tr,meta:{displayInSidenav:"Audit",restricted:gn(mn(Z.PENDING_AUDITOR),mn(Z.APPROVED_AUDITOR)),forceRedirectTo:"status",hidden:bn(gn(mn(Z.PENDING_AUDITOR),mn(Z.APPROVED_AUDITOR)))}},{name:"logs",path:"/logs",component:vn,meta:{displayInSidenav:"",forceRedirectTo:"status",hidden:function(e){var t=e.config;return!(null!==t&&void 0!==t&&t.activate_log)}}},{path:"*",redirect:"dashboard"}],kn=new d["a"]({routes:wn,base:""}),xn=kn,yn={props:{value:Boolean},data:function(){return{drawer:!0}},watch:{value:function(){this.drawer=this.value}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(l["c"])(["mmIsOpen","config"])),Object(l["c"])("auth",["registered"])),Object(l["c"])("status",["approved"])),{},{sidenav:function(){var e,t=this,r=wn.filter((function(e){var t;return void 0!==(null===e||void 0===e||null===(t=e.meta)||void 0===t?void 0:t.displayInSidenav)})).map((function(e){return{icon:"mdi-wallet",label:e.name.charAt(0).toUpperCase()+e.name.slice(1),route:e.name,meta:e.meta,restricted:e.meta.restricted,disabled:function(){return t.mmIsOpen||e.meta.restricted&&!e.meta.restricted({store:t.$store})},hidden:e.meta.hidden}})),n=[],a=[],o=Object(u["a"])(r);try{for(o.s();!(e=o.n()).done;){var s=e.value;s.hidden&&s.hidden({store:this.$store,config:this.config})||(s.meta&&""!==s.meta.displayInSidenav&&!a.includes(s.meta.displayInSidenav)&&(n.push({subheader:!0,label:s.meta.displayInSidenav}),a.push(s.meta.displayInSidenav)),n.push(s))}}catch(c){o.e(c)}finally{o.f()}return n}}),mounted:function(){console.log("routes",wn)},methods:{drawerChange:function(){this.$emit("input",this.drawer)},goTo:function(e){this.$route.name!==e&&this.$router.push({name:e})}}},Rn=yn,On=Object(U["a"])(Rn,c,i,!1,null,null,null),_n=On.exports,An=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-dialog",{attrs:{width:"500",persistent:""},model:{value:e.display,callback:function(t){e.display=t},expression:"display"}},[r("v-card",[r("v-card-title",[e._v("Transaction authentication")]),r("v-card-text",[e._v(" Enter the password for the wallet "+e._s(e.walletAddress)+" : "),r("v-text-field",{attrs:{type:"password"},model:{value:e.walletPassword,callback:function(t){e.walletPassword=t},expression:"walletPassword"}}),r("div",{staticStyle:{color:"red"}},[e._v(e._s(e.errorMessage))])],1),r("v-card-actions",[r("v-btn",{on:{click:e.cancel}},[e._v("Cancel")]),r("v-btn",{attrs:{loading:e.loading,disabled:""===e.walletPassword||e.loading},on:{click:e.submit}},[e._v(" Confirm ")])],1)],1)],1)},Cn=[],jn={data:function(){return{walletAddress:null,errorMessage:null,display:!1,loading:!1,walletPassword:"",submit:function(){},cancel:function(){}}},methods:{authenticate:function(e,t){var r=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e&&t){n.next=2;break}throw new Error("Invalid call to the authenticate function, missing parameters");case 2:return r.walletAddress=e,r.display=!0,n.prev=4,n.next=7,new Promise((function(e,n){function a(){return o.apply(this,arguments)}function o(){return o=Object(h["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!this.walletAddress||!this.walletPassword){r.next=19;break}return this.loading=!0,r.prev=2,r.next=5,t.authenticate(this.walletAddress,this.walletPassword);case 5:if(a=r.sent,a){r.next=8;break}throw new Error("Missing token from authenticate without real error");case 8:e(a),r.next=14;break;case 11:r.prev=11,r.t0=r["catch"](2),this.errorMessage=r.t0.message;case 14:return r.prev=14,this.loading=!1,r.finish(14);case 17:r.next=20;break;case 19:n(new Error("No wallet address or password"));case 20:case"end":return r.stop()}}),r,this,[[2,11,14,17]])}))),o.apply(this,arguments)}function s(){n(new Error("Authentication cancelled by user"))}r.submit=a.bind(r),r.cancel=s.bind(r)}));case 7:return a=n.sent,n.abrupt("return",a);case 9:return n.prev=9,r.walletPassword="",r.errorMessage=null,r.display=!1,n.finish(9);case 14:case"end":return n.stop()}}),n,null,[[4,,9,14]])})))()}}},In=jn,Nn=Object(U["a"])(In,An,Cn,!1,null,null,null),Pn=Nn.exports,Dn={components:{AppMenu:_n,WalletAuthenticationDialog:Pn},data:function(){return{drawerDisplayed:!0}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(l["e"])(["displaySnackbar","snackbarMessage","snackbarColor"])),Object(l["c"])(["mmIsOpen"])),Object(l["c"])("auth",["wallet","walletRole","chainName","mmConnecting"])),Object(l["c"])("nodes",["currentBlockNumber"])),methods:Object(s["a"])(Object(s["a"])({},Object(l["a"])("auth",["detectProvider","disconnect","cancelWalletConnection"])),{},{showDrawer:function(){this.drawerDisplayed=!0}}),mounted:function(){it.set("auth/walletAuthenticationFunction",this.$refs.walletAuthenticationDialog.authenticate)}},Sn=Dn,En=Object(U["a"])(Sn,a,o,!1,null,null,null),Bn=En.exports,Un=r("ce5b"),Tn=r.n(Un);r("bf40");n["default"].use(Tn.a);var Mn=new Tn.a({theme:{themes:{light:{primary:"#607d8b",secondary:"#009688",accent:"#4caf50",error:"# e91e63",warning:"#cddc39",info:"#3f51b5",success:"#8bc34"}}}}),Vn=(r("d5e8"),r("5363"),!1);function Fn(){return Ln.apply(this,arguments)}function Ln(){return Ln=Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){Vn?e():window.addEventListener("load",(function(){e()}),{once:!0})}));case 2:case"end":return e.stop()}}),e)}))),Ln.apply(this,arguments)}function Wn(e,t){e.beforeEach(function(){var e=Object(h["a"])(regeneratorRuntime.mark((function e(r,n,a){var o,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Fn();case 2:if(console.log("routing ",n.name,r.name),"installMetaMask"!==r.name){e.next=5;break}return e.abrupt("return",a());case 5:if("logs"!==r.name){e.next=7;break}return e.abrupt("return",a());case 7:if(t.state.auth.providerModel){e.next=16;break}return console.log("no auth provider yet"),e.next=11,t.dispatch("auth/detectProvider");case 11:if(console.log("Didn't find any provider in the app, trying to detect one. Provider found?",t.state.auth.providerModel,t.state.auth.provider),"both"!=t.state.auth.providerModel){e.next=14;break}return e.abrupt("return",a({name:"authentication"}));case 14:if(t.state.auth.provider){e.next=16;break}return e.abrupt("return",a({name:"installMetaMask"}));case 16:if(t.state.auth.contract||t.commit("auth/contract",kt()),"authentication"!==r.name){e.next=19;break}return e.abrupt("return",a());case 19:return e.next=21,t.dispatch("auth/checkNetworkProofOfCarbonReduction");case 21:if(o=e.sent,!o){e.next=25;break}return t.dispatch("errorFlash","The connected network is probably not a Proof of Carbon Reduction network: ".concat(o)),e.abrupt("return",a({name:"installMetaMask"}));case 25:if(t.state.auth.wallet){e.next=31;break}return console.log("Didn't find the wallet in the app. Trying to fetch it..."),e.next=29,t.dispatch("auth/attemptToConnectWallet");case 29:s=e.sent,console.log("Found a connected wallet.",s);case 31:if(r.meta&&r.meta.restricted){e.next=33;break}return e.abrupt("return",a());case 33:if(r.meta.restricted({store:t})){e.next=40;break}return console.log("Didn't find the proper authorizations to go to this route. Checking again with the smart contract..."),e.next=37,Promise.all([t.dispatch("auth/fetchIsRegistered"),t.dispatch("status/fetchIsApproved"),t.dispatch("auth/fetchRole")]);case 37:if(r.meta.restricted({store:t})){e.next=39;break}return e.abrupt("return",a({name:r.meta.forceRedirectTo}));case 39:console.log("Found the proper authorizations.");case 40:return e.abrupt("return",a());case 41:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}())}window.addEventListener("load",(function(){Vn=!0}),{once:!0}),n["default"].config.productionTip=!1,Wn(xn,it),new n["default"]({vuetify:Mn,store:it,router:xn,render:function(e){return e(Bn)}}).$mount("#app")},6:function(e,t){},7:function(e,t){},8:function(e,t){},9:function(e,t){}});
//# sourceMappingURL=index.bc79b607.js.map