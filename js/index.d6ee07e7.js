(function(e){function t(t){for(var n,s,c=t[0],i=t[1],u=t[2],d=0,p=[];d<c.length;d++)s=c[d],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&p.push(a[s][0]),a[s]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);l&&l(t);while(p.length)p.shift()();return o.push.apply(o,u||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,c=1;c<r.length;c++){var i=r[c];0!==a[i]&&(n=!1)}n&&(o.splice(t--,1),e=s(s.s=r[0]))}return e}var n={},a={index:0},o=[];function s(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=n,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=i;o.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},1:function(e,t){},10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},15:function(e,t){},16:function(e,t){},17:function(e,t){},18:function(e,t){},19:function(e,t){},2:function(e,t){},20:function(e,t){},21:function(e,t){},22:function(e,t){},23:function(e,t){},24:function(e,t){},25:function(e,t){},26:function(e,t){},27:function(e,t){},28:function(e,t){},3:function(e,t){},4:function(e,t){},5:function(e,t){},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",{attrs:{id:"inspire"}},[r("v-container",[r("app-menu"),r("v-app-bar",{attrs:{app:"","clipped-left":"",flat:"",color:"teal lighten-2"}},[r("v-toolbar-title",[e._v(" Audit UI ")])],1),r("v-main",[r("v-container",{staticClass:"py-8"},[r("router-view")],1)],1)],1),r("v-overlay",{attrs:{value:e.mmIsOpen}},[r("v-progress-circular",{attrs:{indeterminate:""}})],1),r("v-snackbar",{attrs:{"multi-line":"",color:e.snackbarColor,right:""},model:{value:e.displaySnackbar,callback:function(t){e.displaySnackbar=t},expression:"displaySnackbar"}},[e._v(" "+e._s(e.snackbarMessage)+" ")])],1)},o=[],s=r("5530"),c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-navigation-drawer",{attrs:{app:"",clipped:"",flat:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[r("v-divider"),r("v-list",[r("v-list-item-group",{attrs:{value:e.$route.name,mandatory:"",color:"primary"}},[e._l(e.sidenav,(function(t,n){var a=t.icon,o=t.label,s=t.route,c=t.disabled,i=t.subheader;return[i&&""!==o&&0!==n?r("v-divider",{key:o+"-divider"}):e._e(),i&&""!==o?r("v-subheader",{key:o},[e._v(e._s(o))]):r("v-list-item",{key:s,attrs:{value:s,disabled:c(),link:""},on:{click:function(t){return e.goTo(s)}}},[r("v-list-item-icon",[r("v-icon",[e._v(e._s(a))])],1),r("v-list-item-content",[r("v-list-item-title",[e._v(e._s(o))])],1)],1)]}))],2)],1)],1)},i=[],u=r("b85c"),l=(r("d81d"),r("4de4"),r("d3b7"),r("b0c0"),r("fb6a"),r("caad"),r("7ffd")),d=r("8c4f"),p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e._v("Install MetaMask and then reload this application.")])},f=[],v={},m=v,h=r("2877"),b=Object(h["a"])(m,p,f,!1,null,null,null),g=b.exports,w=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("v-btn",{attrs:{color:"teal",dark:""},on:{click:e.openMetaMaskConnectionDialog}},[e._v("Connect Wallet")])],1)},x=[],y={methods:Object(s["a"])({},Object(l["a"])("auth",["openMetaMaskConnectionDialog"]))},O=y,k=Object(h["a"])(O,w,x,!1,null,null,null),A=k.exports,j=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-row",[e._v(" Auditors ")])},R=[],_={},N=_,P=Object(h["a"])(N,j,R,!1,null,null,null),I=P.exports,V=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-row",[r("v-col",[r("v-card",[r("v-card-title",[e._v("Number of Nodes")]),r("v-card-text",[e._v(e._s(e.nbOfNodes))])],1)],1),r("v-col",[r("v-card",[r("v-card-title",[e._v("Total Footprint")]),r("v-card-text",[e._v(e._s(e.totalFootprint)+" ")])],1)],1),r("v-col",{attrs:{cols:"12"}},[r("v-card",[r("v-card-title",[e._v("Nodes")]),r("v-card-text",[r("v-data-table",{attrs:{items:e.sealers,headers:e.tableHeaders,"items-per-page":-1,"hide-default-footer":""},scopedSlots:e._u([{key:"item.vanity",fn:function(t){var n=t.item;return[r("div",[e._v("Address: "+e._s(n.address))]),r("div",[e._v("Name: "+e._s(n.vanity.custom))])]}},{key:"item.actions",fn:function(t){var n=t.item;return[r("v-btn",{attrs:{color:"primary",small:""},on:{click:function(t){return e.openUpdateFootprintDialog(n)}}},[e._v(" Update footprint ")])]}}])}),r("v-dialog",{attrs:{width:"500"},model:{value:e.footprintDialog,callback:function(t){e.footprintDialog=t},expression:"footprintDialog"}},[e.selectedSealer?r("v-card",[r("v-card-title",[e._v(" Update Footprint for "+e._s(e.selectedSealer.address)+" ")]),r("v-card-text",[r("v-row",[r("v-col",{staticClass:"pb-0",attrs:{cols:"6"}},[r("v-text-field",{attrs:{type:"number",outlined:"",dense:""},model:{value:e.newFootprintValue,callback:function(t){e.newFootprintValue=t},expression:"newFootprintValue"}})],1),r("v-col",{staticClass:"pb-0"},[r("v-btn",{on:{click:function(t){e.footprintDialog=!1}}},[e._v("Cancel")])],1),r("v-col",{staticClass:"pb-0"},[r("v-btn",{attrs:{color:"primary"},on:{click:e.submitNewFootprint}},[e._v(" Submit ")])],1)],1)],1)],1):e._e()],1)],1)],1)],1),r("v-col",[r("v-card",[r("v-card-title",[e._v("Number of Auditors")]),r("v-card-text",[e._v(e._s(e.nbAuditors))])],1)],1),r("v-col",{attrs:{cols:"12"}},[r("v-card",[r("v-card-title",[e._v("Auditors")]),r("v-card-text",[r("v-data-table",{attrs:{items:e.auditors,headers:e.tableHeadersAuditors,"items-per-page":-1,"hide-default-footer":""},scopedSlots:e._u([{key:"item.votes",fn:function(t){var n=t.item;return[r("div",[e._v(e._s(n.nbVotes)+" / "+e._s(n.minVotes)+" avant approbation")])]}},{key:"item.actions",fn:function(t){var n=t.item;return[r("v-switch",{attrs:{color:"primary","input-value":n.currentVote},on:{change:function(t){return e.nodeVote(n.address,t)}}},[e._v(" Update footprint ")])]}}])})],1)],1)],1)],1)},S=[],F=r("1da1"),C=(r("99af"),r("96cf"),{data:function(){return{tableHeaders:[{text:"Node",value:"vanity"},{text:"Footprint",value:"footprint"},{text:"Actions",value:"actions",sortable:!1}],tableHeadersAuditors:[{text:"Auditor",value:"address"},{text:"Votes courants",value:"votes"},{text:"Mon Vote",value:"actions",sortable:!1}],footprintDialog:!1,selectedSealer:null,newFootprintValue:0}},computed:Object(s["a"])(Object(s["a"])({},Object(l["c"])("audit",["nbOfNodes","totalFootprint","sealers"])),Object(l["c"])("nodeGovernance",["nbAuditors","auditors"])),mounted:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.fetchAllValues(),t.next=3,e.fetchAllAuditorsValues();case 3:case"end":return t.stop()}}),t)})))()},methods:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(l["a"])("audit",["fetchAllValues","updateFootprint"])),Object(l["a"])("nodeGovernance",["fetchAllAuditorsValues","voteAuditor"])),{},{openUpdateFootprintDialog:function(e){this.selectedSealer=e,this.newFootprintValue=e.footprint,this.footprintDialog=!0},submitNewFootprint:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.footprintDialog=!1,t.next=3,e.updateFootprint({sealerAddress:e.selectedSealer.address,footprint:e.newFootprintValue});case 3:case"end":return t.stop()}}),t)})))()},nodeVote:function(e,t){var r=this;return Object(F["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.log("address : ".concat(e," / switch value : ").concat(!!t)),n.next=3,r.voteAuditor({auditorAddress:e,accept:!!t});case 3:case"end":return n.stop()}}),n)})))()}})}),T=C,M=Object(h["a"])(T,V,S,!1,null,null,null),B=M.exports,H=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-row",[r("v-tabs",{attrs:{centered:"","slider-color":"primary"},model:{value:e.currentTab,callback:function(t){e.currentTab=t},expression:"currentTab"}},[r("v-tab",{attrs:{href:"#footprints"}},[e._v(" Footprints ")]),r("v-tab",{attrs:{href:"#pledges"}},[e._v(" Pledges ")])],1),r("v-tabs-items",{staticStyle:{width:"100%"},model:{value:e.currentTab,callback:function(t){e.currentTab=t},expression:"currentTab"}},[r("v-tab-item",{attrs:{value:"footprints"}},[r("v-card",[r("v-card-text",[r("v-data-table",{attrs:{items:e.footprintHistory,headers:e.footprintTableHeaders,"items-per-page":-1,"hide-default-footer":""}})],1)],1)],1),r("v-tab-item",{attrs:{value:"pledges"}},[r("v-card",[r("v-card-text",[r("v-data-table",{attrs:{items:e.pledgeHistory,headers:e.pledgeTableHeaders,"items-per-page":-1,"hide-default-footer":""}})],1)],1)],1)],1)],1)},D=[],E={data:function(){return{currentTab:"footprints",footprintTableHeaders:[{text:"Block N°",value:"blockNumber"},{text:"Node address",value:"node"},{text:"Assigned Footprint",value:"footprint"}],pledgeTableHeaders:[{text:"Block N°",value:"blockNumber"},{text:"Auditor address",value:"node"},{text:"Pledge",value:"pledge"}]}},computed:Object(s["a"])({},Object(l["c"])("history",["footprintHistory","pledgeHistory"])),mounted:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.fetchAllValues();case 1:case"end":return t.stop()}}),t)})))()},methods:Object(s["a"])({},Object(l["a"])("history",["fetchAllValues"]))},$=E,G=Object(h["a"])($,H,D,!1,null,null,null),W=G.exports,U=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-row",{attrs:{wrap:""}},[r("v-col",{attrs:{cols:"12"}},[r("v-card",[r("v-card-title",[e._v("Current Wallet Balance")]),r("v-card-text",[e._v(" "+e._s(e.toEther(e.balance))+" CRC ")])],1)],1),r("v-col",{attrs:{cols:"8"}},[r("v-card",[r("v-card-title",[e._v("Pledge Informations")]),r("v-card-text",[r("div",[e._v(" Min pledge to start audit: "+e._s(e.toEther(e.minPledgeAmount))+" CRC ")]),r("div",[e._v("Current pledged amount: "+e._s(e.pledgedAmount)+" CRC")]),r("v-btn",{attrs:{small:"",disabled:0===e.pledgedAmount||!e.redeemBool},on:{click:e.redeemPledge}},[e._v("Redeem Pledge")])],1)],1)],1),r("v-col",[r("v-card",[r("v-card-title",[e._v("Pledge Actions")]),r("v-card-text",[r("v-row",[r("v-col",{staticClass:"pb-0",attrs:{cols:"12"}},[r("v-text-field",{attrs:{dense:"","hide-details":"",outlined:"",type:"number",min:0,placeholder:"Amount to add to the pledge"},model:{value:e.amountToAdd,callback:function(t){e.amountToAdd=t},expression:"amountToAdd"}})],1),r("v-col",{attrs:{cols:"12"}},[r("v-btn",{staticStyle:{width:"100%"},attrs:{small:""},on:{click:e.pledgeMore}},[e._v("Pledge more")])],1)],1)],1)],1)],1)],1)},J=[],q=r("901e"),L=Math.pow(10,9),Y=Math.pow(10,18);function z(e){return new q["BigNumber"](e)}function K(e){return z(e).div(z(Y))}function Q(e,t){var r=z(e);return"ether"===t?r.multipliedBy(Y):"gwei"===t?r.multipliedBy(L):r}var X={data:function(){return{intervalId:null,amountToAdd:0}},computed:Object(s["a"])({},Object(l["c"])("pledge",["balance","minPledgeAmount","pledgedAmount","redeemBool"])),mounted:function(){this.fetchAllValues(),this.intervalId=setInterval(this.fetchAllValues,6e4)},beforeRouteLeave:function(e,t,r){clearInterval(this.intervalId),r()},methods:Object(s["a"])(Object(s["a"])({toEther:K},Object(l["a"])("pledge",["fetchAllValues","addToPledge","redeemPledge"])),{},{pledgeMore:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.addToPledge(e.amountToAdd);case 2:e.amountToAdd=0;case 3:case"end":return t.stop()}}),t)})))()}})},Z=X,ee=Object(h["a"])(Z,U,J,!1,null,null,null),te=ee.exports,re=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",{staticClass:"pa-md-4 mx-lg-auto"},[r("v-card-title",[e._v(" Status ")]),e.registered&&e.approved?r("v-card-subtitle",{staticStyle:{color:"Green"}},[e._v(" APPROVED ")]):e._e(),e.registered&&!e.approved?r("v-card-subtitle",{staticStyle:{color:"red"}},[e._v(" AWAITING APPROVAL ")]):e._e(),e.registered?e._e():r("v-card-text",[r("p",[e._v(" You are not registered, please make sure to register "),r("v-btn",{staticClass:"mx-2",attrs:{small:"",disabled:e.mmIsOpen},on:{click:e.selfRegister}},[e._v(" Self register ")])],1)]),e.registered&&!e.approved?r("v-card-text",[r("p",{staticStyle:{color:"black"}},[e._v(" You have the total vote of "+e._s(e.approbationVotes)+" ")])]):e._e()],1)},ne=[],ae={computed:Object(s["a"])(Object(s["a"])({mmIsOpen:Object(l["c"])("mmIsOpen")},Object(l["c"])("auth",["registered"])),Object(l["c"])("status",["approved","approbationVotes"])),mounted:function(){this.fetchIsRegistered(),this.fetchIsApproved(),this.fetchApprobationVotes()},methods:Object(s["a"])(Object(s["a"])({},Object(l["a"])("auth",["fetchIsRegistered","selfRegister"])),Object(l["a"])("status",["fetchIsApproved","fetchApprobationVotes"]))},oe=ae,se=Object(h["a"])(oe,re,ne,!1,null,null,null),ce=se.exports;n["default"].use(d["a"]);var ie=function(e){var t=e.store;return t.state.status.approved},ue=function(e){var t=e.store;return t.state.auth.isNode},le=function(e){var t=e.store;return t.state.auth.isAuditor},de=function(e){var t=e.store;return!t.state.auth.wallet},pe=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){var r,n=Object(u["a"])(t);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a(e))return!0}}catch(o){n.e(o)}finally{n.f()}return!1}},fe=[{name:"dashboard",path:"/dashboard",component:null,meta:{displayInSidenav:""}},{name:"installMetaMask",path:"/installmetamask",component:g},{name:"authentication",path:"/auth",component:A,meta:{displayInSidenav:"",hidden:function(e){var t=e.store;return!de({store:t})}}},{name:"auditors",path:"/auditors",component:I,meta:{displayInSidenav:"Governance",restricted:ue,hidden:pe(de,le)}},{name:"status",path:"/status",component:ce,meta:{displayInSidenav:"Audit",hidden:pe(de,ue)}},{name:"pledge",path:"/pledge",component:te,meta:{displayInSidenav:"Audit",restricted:ie,hidden:pe(de,ue)}},{name:"audit",path:"/audit",component:B,meta:{displayInSidenav:"Audit",restricted:ie,hidden:pe(de,ue)}},{name:"history",path:"/history",component:W,meta:{displayInSidenav:"Audit",restricted:ie,hidden:pe(de,ue)}},{path:"*",redirect:"dashboard"}],ve=new d["a"]({routes:fe,base:"",mode:"history"}),me=ve,he={data:function(){return{drawer:null}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(l["c"])(["mmIsOpen"])),Object(l["c"])("auth",["registered"])),Object(l["c"])("status",["approved"])),{},{sidenav:function(){var e,t=this,r=fe.filter((function(e){var t;return void 0!==(null===e||void 0===e||null===(t=e.meta)||void 0===t?void 0:t.displayInSidenav)})).map((function(e){return{icon:"mdi-wallet",label:e.name.charAt(0).toUpperCase()+e.name.slice(1),route:e.name,meta:e.meta,restricted:e.meta.restricted,disabled:function(){return t.mmIsOpen||e.meta.restricted&&!e.meta.restricted({store:t.$store})},hidden:e.meta.hidden}})),n=[],a=[],o=Object(u["a"])(r);try{for(o.s();!(e=o.n()).done;){var s=e.value;s.hidden&&s.hidden({store:this.$store})||(s.meta&&""!==s.meta.displayInSidenav&&!a.includes(s.meta.displayInSidenav)&&(n.push({subheader:!0,label:s.meta.displayInSidenav}),a.push(s.meta.displayInSidenav)),n.push(s))}}catch(c){o.e(c)}finally{o.f()}return n}}),mounted:function(){console.log("routes",fe)},methods:{goTo:function(e){this.$route.name!==e&&this.$router.push({name:e})}}},be=he,ge=Object(h["a"])(be,c,i,!1,null,null,null),we=ge.exports,xe={components:{AppMenu:we},data:function(){return{}},computed:Object(s["a"])(Object(s["a"])({},Object(l["e"])(["displaySnackbar","snackbarMessage","snackbarColor"])),Object(l["c"])(["mmIsOpen"])),methods:Object(s["a"])({},Object(l["a"])("auth",["detectProvider"]))},ye=xe,Oe=Object(h["a"])(ye,a,o,!1,null,null,null),ke=Oe.exports,Ae=r("ce5b"),je=r.n(Ae);r("bf40");n["default"].use(je.a);var Re=new je.a({theme:{themes:{light:{primary:"#607d8b",secondary:"#009688",accent:"#4caf50",error:"# e91e63",warning:"#cddc39",info:"#3f51b5",success:"#8bc34"}}}}),_e=(r("d5e8"),r("5363"),r("2f62")),Ne=l["b"];l["b"].options.mapping="simple";r("4e82"),r("07ac"),r("2ca0"),r("25eb"),r("a9e3"),r("c35a"),r("4c53");var Pe=r("99e5"),Ie=r.n(Pe),Ve=r("86b4"),Se=(r("33d1"),r("ea98"),r("ac1f"),r("1276"),r("e9c4"),r("a15b"),r("a434"),r("d9e2"),r("cde1")),Fe=r("b955"),Ce=r.n(Fe);function Te(e){return Me.apply(this,arguments)}function Me(){return Me=Object(F["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,new Ie.a(It.get("auth/provider")).eth.getBalance(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),Me.apply(this,arguments)}var Be="0x0000000000000000000000000000000000000100";function He(e){var t=Ce.a.get(e),r=t.at(Be);return console.log("Instance",r),r}function De(){return He("Governance")}function Ee(e){return new Se["Web3FunctionProvider"](e,(function(e){return Promise.resolve(e[0])}))}function $e(e){return Ge.apply(this,arguments)}function Ge(){return Ge=Object(F["a"])(regeneratorRuntime.mark((function e(t){var r,n,a,o,s,c=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=It.get("auth/provider"),n=It.get("auth/contract"),t in n){e.next=4;break}return e.abrupt("return",Promise.reject(new Error("Method ".concat(t," does not exists in contract"))));case 4:for(a=c.length,o=new Array(a>1?a-1:0),s=1;s<a;s++)o[s-1]=c[s];return e.abrupt("return",n[t].apply(n,[Ee(r).call({maxGas:1e7})].concat(o)));case 6:case"end":return e.stop()}}),e)}))),Ge.apply(this,arguments)}function We(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Je.apply(void 0,[e,{}].concat(r))}function Ue(e){"string"!==typeof e&&(e='\n {"message":"invalid error message"}');var t=e.split("\n");1==t.length&&(t="\n ".concat(JSON.stringify({message:e})).split("\n"));try{var r=JSON.parse(t.splice(1).join(" "));return r}catch(n){return{message:"invalid JSON message"}}}function Je(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];var o=It.get("auth/provider"),s=It.get("auth/contract");return e in s?new Promise((function(r,a){$e.apply(void 0,[e].concat(n)).then(function(){var a=Object(F["a"])(regeneratorRuntime.mark((function a(c){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log("Tested call",c),a.t0=r,a.next=4,s[e].apply(s,[Ee(o).send(t)].concat(n));case 4:a.t1=a.sent,(0,a.t0)(a.t1);case 6:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()).catch((function(e){var t=Ue(e.message);a(t)}))})):Promise.reject(new Error("Method ".concat(e," does not exists in contract")))}function qe(e,t){return Le.apply(this,arguments)}function Le(){return Le=Object(F["a"])(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=null,e.prev=1,It.set("mmIsOpen",!0),e.next=5,t;case 5:n=e.sent,e.next=13;break;case 8:e.prev=8,e.t0=e["catch"](1),console.log(e.t0),It.dispatch("errorFlash",e.t0.message),r&&r(e.t0);case 13:return e.prev=13,It.set("mmIsOpen",!1),e.finish(13);case 16:return e.abrupt("return",n);case 17:case"end":return e.stop()}}),e,null,[[1,8,13,16]])}))),Le.apply(this,arguments)}var Ye=function(){return{nbOfNodes:0,totalFootprint:0,sealers:[]}},ze={},Ke=l["d"].mutations(Ye);function Qe(e,t,r){return Xe.apply(this,arguments)}function Xe(){return Xe=Object(F["a"])(regeneratorRuntime.mark((function e(t,r,n){var a,o,s,c,i,u,l,d,p,f,v;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=It.get("auth/contract"),o={block:n,sealer:void 0},e.prev=2,"string"!==typeof n.difficulty||n.difficulty.startsWith("0x")||(n.difficulty=Number.parseInt(n.difficulty)),o.sealer=Object(Ve["poaBlockHashToSealerInfo"])(n),s="string"===typeof n.number?Number.parseInt(n.number):n.number,e.t0=t.utils,e.next=9,t.eth.getBalance(o.sealer.address,s);case 9:return e.t1=e.sent,c=e.t0.toBN.call(e.t0,e.t1),e.t2=t.utils,e.next=14,t.eth.getBalance(a.deployedAt,s);case 14:return e.t3=e.sent,i=e.t2.toBN.call(e.t2,e.t3),e.t4=t.utils,e.next=19,t.eth.getBalance(a.deployedAt,s-1);case 19:return e.t5=e.sent,u=e.t4.toBN.call(e.t4,e.t5),l=Number.parseFloat(t.utils.fromWei(i.sub(u))),d=Number.parseFloat(t.utils.fromWei(c,"ether")),e.next=25,a.footprint(r.call(),o.sealer.address);case 25:return p=e.sent,e.next=28,a.totalFootprint(r.call());case 28:return f=e.sent,e.next=31,a.nbNodes(r.call());case 31:v=e.sent,o.sealer.footprint=Number.parseFloat(p),o.sealer.balance=d,o.totalFootprint=Number.parseInt(f),o.totalCrypto=Number.parseFloat(t.utils.fromWei(i,"ether")),o.nbNodes=Number.parseInt(v),o.sealer.lastReward=l,o.receivedAt=Date.now(),e.next=44;break;case 41:e.prev=41,e.t6=e["catch"](2),console.warn("Error in preparing block",e.t6);case 44:return e.abrupt("return",o);case 45:case"end":return e.stop()}}),e,null,[[2,41]])}))),Xe.apply(this,arguments)}var Ze={fetchAllValues:function(e){var t=e.dispatch;t("fetchNumberOfNodes"),t("fetchTotalFootprint"),t("fetchNodeInformations")},fetchNumberOfNodes:function(){return Object(F["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$e("nbNodes");case 2:t=e.sent,It.set("audit/nbOfNodes",t);case 4:case"end":return e.stop()}}),e)})))()},fetchTotalFootprint:function(){return Object(F["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$e("totalFootprint");case 2:t=e.sent,It.set("audit/totalFootprint",t);case 4:case"end":return e.stop()}}),e)})))()},fetchNodeInformations:function(e){return Object(F["a"])(regeneratorRuntime.mark((function t(){var r,n,a,o,s,c,i,u,l,d,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.rootState,n=new Ie.a(r.auth.provider),t.next=4,n.eth.getBlockNumber();case 4:a=t.sent,o=Ee(r.auth.provider),s={},c=0,i=0;case 9:if(!(i<=2)){t.next=23;break}return u=a-c,t.next=13,n.eth.getBlock(u,!1);case 13:return l=t.sent,t.next=16,Qe(n,o,l);case 16:d=t.sent,console.log("block",d.block.number,"sealer",d.sealer),s[d.sealer.address]?s[d.sealer.address].seenCounter++:(s[d.sealer.address]=d.sealer,s[d.sealer.address].seenCounter=1),i<s[d.sealer.address].seenCounter&&(i=s[d.sealer.address].seenCounter),c++,t.next=9;break;case 23:p=Object.values(s).sort((function(e,t){return e.footprint<t.footprint})),It.set("audit/sealers",p);case 25:case"end":return t.stop()}}),t)})))()},updateFootprint:function(e,t){return Object(F["a"])(regeneratorRuntime.mark((function r(){var n,a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.dispatch,a=t.sealerAddress,o=t.footprint,r.next=4,qe(We("setFootprint",a,o));case 4:n("fetchNodeInformations");case 5:case"end":return r.stop()}}),r)})))()}},et={state:Ye,getters:ze,mutations:Ke,actions:Ze,namespaced:!0},tt=r("4c41"),rt=r.n(tt),nt=function(){return{provider:null,wallet:null,contract:null,registered:!1,isNode:!1,isAuditor:!1}},at={},ot=l["d"].mutations(nt),st={fetchRole:function(){return Object(F["a"])(regeneratorRuntime.mark((function e(){var t,r,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=It.get("auth/wallet"),e.next=3,$e("auditorRegistered",t);case 3:return r=e.sent,e.next=6,$e("footprint",t);case 6:n=e.sent,a=!1,0!=n&&(a=!0),It.set("auth/isAuditor",r),It.set("auth/isNode",a);case 11:case"end":return e.stop()}}),e)})))()},detectProvider:function(){return Object(F["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,rt()();case 2:if(t=e.sent,t){e.next=6;break}return me.push({name:"installMetaMask"}),e.abrupt("return");case 6:t.on("accountsChanged",(function(){return window.location.reload()})),It.set("auth/provider",t);case 8:case"end":return e.stop()}}),e)})))()},attemptToConnectWallet:function(){return Object(F["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,window.ethereum.request({method:"eth_accounts"});case 2:if(t=e.sent,r=t.length>0?t[0]:null,r){e.next=6;break}return e.abrupt("return");case 6:return It.set("auth/wallet",r),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})))()},openMetaMaskConnectionDialog:function(){return Object(F["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,window.ethereum.request({method:"eth_requestAccounts"});case 2:if(t=e.sent,0!==t.length){e.next=5;break}return e.abrupt("return");case 5:It.set("auth/wallet",t[0]),me.push({name:"status"});case 7:case"end":return e.stop()}}),e)})))()},fetchIsRegistered:function(e){return Object(F["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.state,t.next=3,qe($e("auditorRegistered",r.wallet));case 3:n=t.sent,It.set("auth/registered",n);case 5:case"end":return t.stop()}}),t)})))()},selfRegister:function(e){return Object(F["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.dispatch,t.next=3,qe(We("selfRegisterAuditor"));case 3:r("fetchIsRegistered"),r("status/fetchIsApproved",null,{root:!0}),r("fetchRole");case 6:case"end":return t.stop()}}),t)})))()}},ct={state:nt,getters:at,mutations:ot,actions:st,namespaced:!0},it=(r("4dd0c"),function(){return{pledgeHistory:[],footprintHistory:[]}}),ut={},lt=Object(s["a"])(Object(s["a"])({},l["d"].mutations(it)),{},{appendFootprint:function(e,t){e.footprintHistory.push(t)},appendPledge:function(e,t){e.pledgeHistory.push(t)}}),dt={fetchAllValues:function(e){var t=e.dispatch,r=new Se["Web3FunctionProvider"](It.get("auth/provider"),(function(){return Promise.resolve(It.get("auth/wallet"))})),n=Ce.a.get("Governance").at(Be);t("fetchFootprintHistory",{contract:n,prov:r}),t("fetchPledgeHistory",{contract:n,prov:r})},fetchFootprintHistory:function(e,t){return Object(F["a"])(regeneratorRuntime.mark((function r(){var n,a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=e.commit,a=t.contract,o=t.prov,It.set("history/footprintHistory",[]),a.events.CarbonFootprintUpdate(o.get({fromBlock:1}),{}).on("log",(function(e){var t={blockNumber:e.blockNumber,node:e.returnValues.node,footprint:e.returnValues.footprint};n("appendFootprint",t)}));case 4:case"end":return r.stop()}}),r)})))()},fetchPledgeHistory:function(e,t){return Object(F["a"])(regeneratorRuntime.mark((function r(){var n,a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.commit,a=t.contract,o=t.prov,It.set("history/pledgeHistory",[]),r.t0=a.events,r.t1=o.get({fromBlock:1}),r.next=7,o.account();case 7:r.t2=r.sent,r.t3={from:r.t2},r.t0.AmountPledged.call(r.t0,r.t1,r.t3).on("log",(function(e){var t={blockNumber:e.blockNumber,node:e.returnValues.from,pledge:K(e.returnValues.amount),total:K(e.returnValues.total)};n("appendPledge",t)}));case 10:case"end":return r.stop()}}),r)})))()}},pt={state:it,getters:ut,mutations:lt,actions:dt,namespaced:!0},ft=function(){return{balance:0,minPledgeAmount:0,pledgedAmount:0,redeemBool:!1}},vt={},mt=l["d"].mutations(ft),ht={fetchAllValues:function(e){var t=e.dispatch;t("fetchBalance"),t("fetchMinPledgeAmount"),t("fetchPledgedAmount"),t("fetchCanTransferPledge")},fetchBalance:function(e){return Object(F["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.rootState,t.next=3,Te(r.auth.wallet);case 3:n=t.sent,It.set("pledge/balance",n);case 5:case"end":return t.stop()}}),t)})))()},fetchCanTransferPledge:function(){return Object(F["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=It.get("auth/wallet"),e.next=3,$e("canTransferPledge",t,"1");case 3:r=e.sent,console.log("just trying",r),It.set("pledge/redeemBool",r);case 6:case"end":return e.stop()}}),e)})))()},fetchMinPledgeAmount:function(){return Object(F["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=It.get("auth/wallet"),e.next=3,$e("minPledgeAmountToAuditNode",t);case 3:r=e.sent,It.set("pledge/minPledgeAmount",r);case 5:case"end":return e.stop()}}),e)})))()},fetchPledgedAmount:function(){return Object(F["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=It.get("auth/wallet"),e.next=3,$e("pledgedAmount",t);case 3:r=e.sent,It.set("pledge/pledgedAmount",K(r));case 5:case"end":return e.stop()}}),e)})))()},addToPledge:function(e,t){return Object(F["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.dispatch,console.log("Pledging",t),r.next=4,qe(Je("pledge",{amount:Q(t,"ether")}));case 4:n("fetchPledgedAmount");case 5:case"end":return r.stop()}}),r)})))()},redeemPledge:function(e){return Object(F["a"])(regeneratorRuntime.mark((function t(){var r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.dispatch,n=It.get("auth/wallet"),a=It.get("pledge/pledgedAmount"),t.next=5,qe(We("transferPledge",n,a));case 5:r("fetchPledgedAmount");case 6:case"end":return t.stop()}}),t)})))()}},bt={state:ft,getters:vt,mutations:mt,actions:ht,namespaced:!0},gt=function(){return{approved:!1,approbationVotes:0}},wt={},xt=l["d"].mutations(gt),yt={fetchIsApproved:function(){return Object(F["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=It.get("auth/wallet"),e.next=3,$e("auditorApproved",t);case 3:r=e.sent,It.set("status/approved",r);case 5:case"end":return e.stop()}}),e)})))()},fetchApprobationVotes:function(){return Object(F["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=It.get("auth/wallet"),e.next=3,$e("auditorVotes",t);case 3:r=e.sent,It.set("status/approbationVotes",Number(r));case 5:case"end":return e.stop()}}),e)})))()}},Ot={state:gt,getters:wt,mutations:xt,actions:yt,namespaced:!0},kt=function(){return{nbAuditors:0,auditors:[]}},At={},jt=l["d"].mutations(kt),Rt={fetchAllAuditorsValues:function(e){return Object(F["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.dispatch,console.log("xxx before fetch nbAudit"),t.next=4,r("fetchNbAuditors");case 4:return console.log("xxx before AuditInfos"),t.next=7,r("fetchAuditorsInfos");case 7:console.log("xxx  after dispatch");case 8:case"end":return t.stop()}}),t)})))()},fetchNbAuditors:function(){return Object(F["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$e("nbAuditors");case 2:t=e.sent,console.log("+++ after readOnlyCall nbAuditors : ".concat(t)),It.set("nodeGovernance/nbAuditors",t);case 5:case"end":return e.stop()}}),e)})))()},fetchAuditorsInfos:function(){return Object(F["a"])(regeneratorRuntime.mark((function e(){var t,r,n,a,o,s,c,i,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("*** before readOnlyCall loop auditors"),e.next=3,$e("nbAuditors");case 3:return t=e.sent,r=It.get("auth/wallet"),e.t0=Math,e.next=8,$e("nbNodes");case 8:e.t1=e.sent,e.t2=e.t1/2,e.t3=e.t0.floor.call(e.t0,e.t2),n=e.t3+1,console.log("*** nbAuditors: ".concat(t)),console.log("*** nodeAdr: ".concat(r)),a=[],o=0;case 16:if(!(o<t)){e.next=39;break}return console.log("*** before loop ".concat(o," auditors call")),e.next=20,$e("auditorAddress",o);case 20:return s=e.sent,console.log("*** after adress call : ".concat(s)),e.next=24,$e("auditorVotes",s);case 24:return c=e.sent,console.log("*** after nbVotes call : ".concat(c)),e.next=28,$e("currentAuditorVote",s,r);case 28:return i=e.sent,console.log("*** after currentVote call : ".concat(i)),e.next=32,$e("auditorApproved",s);case 32:u=e.sent,console.log("*** after isApproved call : ".concat(u)),console.log("*** after loop ".concat(o," auditors call")),a[o]={address:s,nbVotes:c,minVotes:n,currentVote:i,isApproved:u};case 36:o++,e.next=16;break;case 39:console.log("after readOnlyCall loop auditors"),console.dir(a),It.set("nodeGovernance/auditors",a);case 42:case"end":return e.stop()}}),e)})))()},voteAuditor:function(e,t){return Object(F["a"])(regeneratorRuntime.mark((function e(){var r,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.auditorAddress,n=t.accept,console.log("calling voteAuditor for auditor ".concat(r," with value ").concat(n)),e.next=4,qe(We("voteAuditor",r,n));case 4:a=e.sent,console.log("res voteAuditor -> ".concat(a));case 6:case"end":return e.stop()}}),e)})))()}},_t={state:kt,getters:At,mutations:jt,actions:Rt,namespaced:!0};n["default"].use(_e["a"]);var Nt={tryingToConnect:!1,mmIsOpen:!1,displaySnackbar:!1,snackbarMessage:"",snackbarColor:"error"},Pt=new _e["a"].Store({modules:{audit:et,auth:ct,history:pt,pledge:bt,status:Ot,nodeGovernance:_t},plugins:[Ne.plugin],state:Nt,mutations:l["d"].mutations(Nt),actions:{errorFlash:function(e,t){var r=e.commit;r("snackbarMessage",t),r("snackbarColor","error"),r("displaySnackbar",!0)}}}),It=Pt;function Vt(e,t){e.beforeEach(function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(r,n,a){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("installMetaMask"!==r.name){e.next=2;break}return e.abrupt("return",a());case 2:if("authentication"!==r.name){e.next=4;break}return e.abrupt("return",a());case 4:if(t.state.auth.provider){e.next=10;break}return e.next=7,t.dispatch("auth/detectProvider");case 7:if(console.log("Didn't find any provider in the app, trying to detect one. Provider found?",t.state.auth.provider),t.state.auth.provider){e.next=10;break}return e.abrupt("return",a({name:"installMetaMask"}));case 10:if(t.state.auth.wallet){e.next=19;break}return console.log("Didn't find the wallet in the app. Trying to fetch it..."),e.next=14,t.dispatch("auth/attemptToConnectWallet");case 14:if(o=e.sent,o){e.next=18;break}return console.log("Didn't find it. Redirecting to auth."),e.abrupt("return",a({name:"authentication"}));case 18:console.log("Found a connected wallet.");case 19:return t.state.auth.contract||t.commit("auth/contract",De()),e.abrupt("return",a());case 21:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}())}n["default"].config.productionTip=!1,Vt(me,It),new n["default"]({vuetify:Re,store:It,router:me,render:function(e){return e(ke)}}).$mount("#app")},6:function(e,t){},7:function(e,t){},8:function(e,t){},9:function(e,t){}});
//# sourceMappingURL=index.d6ee07e7.js.map